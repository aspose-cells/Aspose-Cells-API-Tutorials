---
title: Εισαγωγή εικόνας στο υποσέλιδο κεφαλίδων
linktitle: Εισαγωγή εικόνας στο υποσέλιδο κεφαλίδων
second_title: Aspose.Cells for .NET API Reference
description: Μάθετε πώς να εισάγετε μια εικόνα στην κεφαλίδα ή το υποσέλιδο ενός εγγράφου Excel χρησιμοποιώντας το Aspose.Cells για .NET. Οδηγός βήμα προς βήμα με τον πηγαίο κώδικα σε C#.
type: docs
weight: 60
url: /el/net/excel-page-setup/insert-image-in-header-footer/
---
Η δυνατότητα εισαγωγής μιας εικόνας στην κεφαλίδα ή το υποσέλιδο ενός εγγράφου του Excel μπορεί να είναι πολύ χρήσιμη για την προσαρμογή των αναφορών σας ή την προσθήκη εταιρικών λογότυπων. Σε αυτό το άρθρο, θα σας καθοδηγήσουμε βήμα προς βήμα για να εισαγάγετε μια εικόνα στην κεφαλίδα ή το υποσέλιδο ενός εγγράφου του Excel χρησιμοποιώντας το Aspose.Cells για .NET. Θα μάθετε πώς να το πετύχετε αυτό χρησιμοποιώντας τον πηγαίο κώδικα C#.

## Βήμα 1: Ρύθμιση περιβάλλοντος

Πριν ξεκινήσετε, βεβαιωθείτε ότι έχετε εγκατεστημένο το Aspose.Cells για .NET στον υπολογιστή σας. Δημιουργήστε επίσης ένα νέο έργο στο περιβάλλον ανάπτυξης που προτιμάτε.

## Βήμα 2: Εισαγάγετε τις απαραίτητες βιβλιοθήκες

Στο αρχείο κώδικα, εισαγάγετε τις βιβλιοθήκες που απαιτούνται για την εργασία με το Aspose.Cells. Εδώ είναι ο αντίστοιχος κωδικός:

```csharp
using Aspose.Cells;
```

## Βήμα 3: Ορισμός καταλόγου εγγράφων

Ορίστε τον κατάλογο όπου βρίσκεται το έγγραφο Excel με το οποίο θέλετε να εργαστείτε. Χρησιμοποιήστε τον ακόλουθο κώδικα για να ορίσετε τον κατάλογο:

```csharp
string dataDir = "YOUR DOCUMENTS DIRECTORY";
```

Βεβαιωθείτε ότι έχετε καθορίσει την πλήρη διαδρομή καταλόγου.

## Βήμα 4: Δημιουργία αντικειμένου βιβλίου εργασίας

Το αντικείμενο Βιβλίο εργασίας αντιπροσωπεύει το έγγραφο του Excel με το οποίο θα εργαστείτε. Μπορείτε να το δημιουργήσετε χρησιμοποιώντας τον παρακάτω κώδικα:

```csharp
Workbook workbook = new Workbook();
```

Αυτό δημιουργεί ένα νέο κενό αντικείμενο βιβλίου εργασίας.

## Βήμα 5: Αποθήκευση της διεύθυνσης URL εικόνας

Καθορίστε τη διεύθυνση URL ή τη διαδρομή της εικόνας που θέλετε να εισαγάγετε στην κεφαλίδα ή το υποσέλιδο. Χρησιμοποιήστε τον ακόλουθο κώδικα για να αποθηκεύσετε τη διεύθυνση URL της εικόνας:

```csharp
string logo_url = dataDir + "aspose-logo.jpg";
```

Βεβαιωθείτε ότι η καθορισμένη διαδρομή είναι σωστή και ότι η εικόνα υπάρχει σε αυτήν τη θέση.

## Βήμα 6: Άνοιγμα του αρχείου εικόνας

Για να ανοίξουμε το αρχείο εικόνας, θα χρησιμοποιήσουμε ένα αντικείμενο FileStream και θα διαβάσουμε τα δυαδικά δεδομένα από την εικόνα. Εδώ είναι ο αντίστοιχος κωδικός:

```csharp
FileStream inFile;
byte[] binaryData;

inFile = new System.IO.FileStream(logo_url, System.IO.FileMode.Open, System.IO.FileAccess.Read);
binaryData = new Byte[inFile.Length];
long bytesRead = inFile.Read(binaryData, 0, (int)inFile.Length);
```

Βεβαιωθείτε ότι η διαδρομή της εικόνας είναι σωστή και ότι έχετε τα σωστά δικαιώματα πρόσβασης σε αυτήν.

## Βήμα 7: Διαμόρφωση του PageSetup

Το αντικείμενο PageSetup χρησιμοποιείται για τον ορισμό των ρυθμίσεων σελίδας εγγράφου Excel, συμπεριλαμβανομένων της κεφαλίδας και του υποσέλιδου. Χρησιμοποιήστε τον ακόλουθο κώδικα για να λάβετε το αντικείμενο PageSetup του πρώτου φύλλου εργασίας:

```csharp
PageSetup pageSetup = workbook. Worksheets

[0].PageSetup;
```

Αυτό θα σας επιτρέψει να αποκτήσετε πρόσβαση στις ρυθμίσεις σελίδας για το πρώτο φύλλο εργασίας στο βιβλίο εργασίας.

## Βήμα 8: Προσθήκη της εικόνας στην κεφαλίδα

Χρησιμοποιήστε τη μέθοδο SetHeaderPicture() του αντικειμένου PageSetup για να ορίσετε την εικόνα στο μεσαίο τμήμα της κεφαλίδας της σελίδας. Εδώ είναι ο αντίστοιχος κωδικός:

```csharp
pageSetup.SetHeaderPicture(1, binaryData);
```

Αυτό θα προσθέσει την καθορισμένη εικόνα στην κεφαλίδα της σελίδας.

## Βήμα 9: Προσθήκη ενός σεναρίου στην κεφαλίδα

Για να προσθέσετε σενάριο στην κεφαλίδα της σελίδας, χρησιμοποιήστε τη μέθοδο SetHeader() του αντικειμένου PageSetup. Εδώ είναι ο αντίστοιχος κωδικός:

```csharp
pageSetup.SetHeader(1, "&G");
```

Αυτό θα προσθέσει το καθορισμένο σενάριο στην κεφαλίδα της σελίδας. Σε αυτό το παράδειγμα, η δέσμη ενεργειών "&G" εμφανίζει τον αριθμό σελίδας.

## Βήμα 10: Προσθήκη ονόματος φύλλου στην κεφαλίδα

Για να εμφανίσετε το όνομα του φύλλου στην κεφαλίδα της σελίδας, χρησιμοποιήστε ξανά τη μέθοδο SetHeader() του αντικειμένου PageSetup. Εδώ είναι ο αντίστοιχος κωδικός:

```csharp
pageSetup.SetHeader(2, "&A");
```

Αυτό θα προσθέσει το όνομα του φύλλου στην κεφαλίδα της σελίδας. Το σενάριο "&A" χρησιμοποιείται για να αναπαραστήσει το όνομα του φύλλου.

## Βήμα 11: Αποθήκευση του βιβλίου εργασίας

Για να αποθηκεύσετε αλλαγές στο βιβλίο εργασίας, χρησιμοποιήστε τη μέθοδο Save() του αντικειμένου Workbook. Εδώ είναι ο αντίστοιχος κωδικός:

```csharp
workbook.Save(dataDir + "InsertImageInHeaderFooter_out.xls");
```

Αυτό θα αποθηκεύσει το βιβλίο εργασίας με τις αλλαγές στον καθορισμένο κατάλογο.

## Βήμα 12: Κλείσιμο του FileStream

Αφού διαβάσετε τα δυαδικά δεδομένα από την εικόνα, φροντίστε να κλείσετε το FileStream για να ελευθερώσετε τους πόρους. Χρησιμοποιήστε τον ακόλουθο κώδικα για να κλείσετε το FileStream:

```csharp
inFile.Close();
```

Φροντίστε να κλείνετε πάντα τα FileStream όταν τελειώσετε τη χρήση τους.

### Δείγμα πηγαίου κώδικα για Εισαγωγή εικόνας στο υποσέλιδο κεφαλίδας χρησιμοποιώντας Aspose.Cells για .NET 
```csharp
//Η διαδρομή προς τον κατάλογο εγγράφων.
string dataDir = "YOUR DOCUMENT DIRECTORY";
//Δημιουργία αντικειμένου βιβλίου εργασίας
Workbook workbook = new Workbook();
// Δημιουργία μεταβλητής συμβολοσειράς για την αποθήκευση του url του λογότυπου/εικόνας
string logo_url = dataDir + "aspose-logo.jpg";
// Δήλωση αντικειμένου FileStream
FileStream inFile;
// Δήλωση πίνακα byte
byte[] binaryData;
// Δημιουργία της παρουσίας του αντικειμένου FileStream για να ανοίξει το λογότυπο/εικόνα στη ροή
inFile = new System.IO.FileStream(logo_url, System.IO.FileMode.Open, System.IO.FileAccess.Read);
// Στιγμιότυπο του πίνακα byte του μεγέθους του αντικειμένου FileStream
binaryData = new Byte[inFile.Length];
// Διαβάζει ένα μπλοκ byte από τη ροή και γράφει δεδομένα σε ένα δεδομένο buffer πίνακα byte.
long bytesRead = inFile.Read(binaryData, 0, (int)inFile.Length);
// Δημιουργία αντικειμένου PageSetup για λήψη των ρυθμίσεων σελίδας του πρώτου φύλλου εργασίας του βιβλίου εργασίας
PageSetup pageSetup = workbook.Worksheets[0].PageSetup;
// Ρύθμιση του λογότυπου/εικόνας στο κεντρικό τμήμα της κεφαλίδας της σελίδας
pageSetup.SetHeaderPicture(1, binaryData);
// Ρύθμιση του σεναρίου για το λογότυπο/εικόνα
pageSetup.SetHeader(1, "&G");
// Ρύθμιση του ονόματος του φύλλου στη δεξιά ενότητα της κεφαλίδας της σελίδας με το σενάριο
pageSetup.SetHeader(2, "&A");
// Αποθήκευση του βιβλίου εργασίας
workbook.Save(dataDir + "InsertImageInHeaderFooter_out.xls");
//Κλείσιμο του αντικειμένου FileStream
inFile.Close();       
```
## συμπέρασμα

Συγχαρητήρια ! Τώρα γνωρίζετε πώς να εισαγάγετε μια εικόνα στην κεφαλίδα ή το υποσέλιδο ενός εγγράφου Excel χρησιμοποιώντας το Aspose.Cells για .NET. Αυτό το σεμινάριο σας καθοδήγησε σε κάθε βήμα της διαδικασίας, από τη ρύθμιση του περιβάλλοντος έως την αποθήκευση του τροποποιημένου βιβλίου εργασίας. Μη διστάσετε να πειραματιστείτε περισσότερο με τις δυνατότητες του Aspose.Cells για να δημιουργήσετε εξατομικευμένα και επαγγελματικά έγγραφα Excel.

### Συχνές ερωτήσεις

#### Ε1: Είναι δυνατή η εισαγωγή πολλών εικόνων στην κεφαλίδα ή στο υποσέλιδο ενός εγγράφου Excel;

A1: Ναι, μπορείτε να εισαγάγετε πολλές εικόνες στην κεφαλίδα ή το υποσέλιδο ενός εγγράφου Excel επαναλαμβάνοντας τα βήματα 8 και 9 για κάθε επιπλέον εικόνα.

#### Ε2: Ποιες μορφές εικόνας υποστηρίζονται για εισαγωγή στην κεφαλίδα ή στο υποσέλιδο;
A2: Το Aspose.Cells υποστηρίζει μια ποικιλία κοινών μορφών εικόνας όπως JPEG, PNG, GIF, BMP κ.λπ.

#### Ε3: Μπορώ να προσαρμόσω περαιτέρω την εμφάνιση της κεφαλίδας ή του υποσέλιδου;

A3: Ναι, μπορείτε να χρησιμοποιήσετε ειδικά σενάρια και κωδικούς για περαιτέρω μορφοποίηση και προσαρμογή της εμφάνισης της κεφαλίδας ή του υποσέλιδου. Ανατρέξτε στην τεκμηρίωση Aspose.Cells για περισσότερες πληροφορίες σχετικά με τις επιλογές προσαρμογής.

#### Ε4: Λειτουργεί το Aspose.Cells με διαφορετικές εκδόσεις του Excel;

A4: Ναι, το Aspose.Cells είναι συμβατό με διαφορετικές εκδόσεις του Excel, συμπεριλαμβανομένων των Excel 2003, Excel 2007, Excel 2010, Excel 2013, Excel 2016 και Excel 2019.

#### Ε5: Είναι δυνατή η εισαγωγή εικόνων σε άλλα μέρη του εγγράφου Excel, όπως κελιά ή γραφήματα;

A5: Ναι, το Aspose.Cells παρέχει εκτεταμένες λειτουργίες για την εισαγωγή εικόνων σε διαφορετικά μέρη του εγγράφου Excel, συμπεριλαμβανομένων κελιών, γραφημάτων και αντικειμένων σχεδίασης.