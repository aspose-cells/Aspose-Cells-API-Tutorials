---
title: Προστασία γραμμής στο φύλλο εργασίας του Excel
linktitle: Προστασία γραμμής στο φύλλο εργασίας του Excel
second_title: Aspose.Cells for .NET API Reference
description: Ανακαλύψτε σε αυτό το σεμινάριο πώς να προστατεύσετε τις σειρές ενός υπολογιστικού φύλλου Excel χρησιμοποιώντας το Aspose.Cells για .NET. Βήμα προς βήμα μάθημα σε C#.
type: docs
weight: 60
url: /el/net/protect-excel-file/protect-row-in-excel-worksheet/
---
Σε αυτό το σεμινάριο, θα εξετάσουμε κάποιο πηγαίο κώδικα C# που χρησιμοποιεί τη βιβλιοθήκη Aspose.Cells για την προστασία των σειρών σε ένα υπολογιστικό φύλλο Excel. Θα περιηγηθούμε σε κάθε βήμα του κώδικα και θα εξηγήσουμε πώς λειτουργεί. Ακολουθήστε προσεκτικά τις οδηγίες για να έχετε τα επιθυμητά αποτελέσματα.

## Βήμα 1: Προαπαιτούμενα

Πριν ξεκινήσετε, βεβαιωθείτε ότι έχετε εγκαταστήσει τη βιβλιοθήκη Aspose.Cells για .NET. Μπορείτε να το αποκτήσετε από την επίσημη ιστοσελίδα του Aspose. Βεβαιωθείτε επίσης ότι έχετε μια πρόσφατη έκδοση του Visual Studio ή οποιουδήποτε άλλου περιβάλλοντος ανάπτυξης C#.

## Βήμα 2: Εισαγάγετε τους απαιτούμενους χώρους ονομάτων

Για να χρησιμοποιήσουμε τη βιβλιοθήκη Aspose.Cells, πρέπει να εισαγάγουμε τους απαραίτητους χώρους ονομάτων στον κώδικά μας. Προσθέστε τις ακόλουθες γραμμές στην κορυφή του αρχείου πηγής C#:

```csharp
using Aspose.Cells;
```

## Βήμα 3: Δημιουργία βιβλίου εργασίας του Excel

Σε αυτό το βήμα, θα δημιουργήσουμε ένα νέο βιβλίο εργασίας του Excel. Χρησιμοποιήστε τον ακόλουθο κώδικα για να δημιουργήσετε ένα βιβλίο εργασίας του Excel:

```csharp
// Διαδρομή στον κατάλογο εγγράφων.
string dataDir = "YOUR_DIRECTORY_OF_DOCUMENTS";

// Δημιουργήστε ένα νέο βιβλίο εργασίας.
Workbook wb = new Workbook();
```

 Φροντίστε να αντικαταστήσετε`"YOUR_DOCUMENTS_DIR"` με την κατάλληλη διαδρομή προς τον κατάλογο των εγγράφων σας.

## Βήμα 4: Δημιουργία υπολογιστικού φύλλου

Τώρα που δημιουργήσαμε το βιβλίο εργασίας του Excel, ας δημιουργήσουμε ένα φύλλο εργασίας και ας πάρουμε το πρώτο φύλλο. Χρησιμοποιήστε τον ακόλουθο κώδικα:

```csharp
// Δημιουργήστε ένα αντικείμενο υπολογιστικού φύλλου και λάβετε το πρώτο φύλλο.
Worksheet sheet = wb.Worksheets[0];
```

## Βήμα 5: Καθορισμός του Στυλ

Σε αυτό το βήμα, θα ορίσουμε το στυλ που θα εφαρμοστεί στις σειρές του υπολογιστικού φύλλου. Χρησιμοποιήστε τον ακόλουθο κώδικα:

```csharp
// Ορισμός του αντικειμένου στυλ.
Styling styling;
```

## Βήμα 6: Κάντε βρόχο για να ξεκλειδώσετε όλες τις στήλες

Τώρα θα κάνουμε βρόχο σε όλες τις στήλες στο φύλλο εργασίας και θα τις ξεκλειδώσουμε. Χρησιμοποιήστε τον ακόλουθο κώδικα:

```csharp
// Κάντε βρόχο σε όλες τις στήλες του φύλλου εργασίας και ξεκλειδώστε τις.
for (int i = 0; i <= 255; i++)
{
     style = sheet.Cells.Columns[(byte)i].Style;
     style. IsLocked = false;
     sheet.Cells.Columns[(byte)i].ApplyStyle(style);
}
```

## Βήμα 7: Κλείδωμα της πρώτης γραμμής

Σε αυτό το βήμα, θα κλειδώσουμε την πρώτη σειρά του φύλλου εργασίας. Χρησιμοποιήστε τον ακόλουθο κώδικα:

```csharp
// Αποκτήστε το στυλ της πρώτης γραμμής.
style = sheet.Cells.Rows[0].Style;
// Κλειδώστε το στυλ.
style. IsLocked = true;
// Εφαρμόστε το στυλ στην πρώτη γραμμή.
sheet.Cells.ApplyRowStyle(0, style);
```

## Βήμα 8: Προστασία του φύλλου εργασίας

Τώρα που ορίσαμε τα στυλ και κλειδώσαμε τις σειρές, ας προστατεύσουμε το υπολογιστικό φύλλο. Χρησιμοποιήστε τον ακόλουθο κώδικα:

```csharp
// Προστατέψτε το φύλλο εργασίας.
sheet.Protect(ProtectionType.All);
```

## Βήμα 9: Αποθήκευση του αρχείου Excel

Τέλος, θα αποθηκεύσουμε το τροποποιημένο αρχείο Excel. Χρησιμοποιήστε τον ακόλουθο κώδικα:

```csharp
// Αποθηκεύστε το αρχείο Excel.
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```

Βεβαιωθείτε ότι έχετε καθορίσει τη σωστή διαδρομή για την αποθήκευση του τροποποιημένου αρχείου Excel.

### Δείγμα πηγαίου κώδικα για Protect Row In Excel Worksheet χρησιμοποιώντας Aspose.Cells για .NET 
```csharp
//Η διαδρομή προς τον κατάλογο εγγράφων.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// Δημιουργήστε κατάλογο εάν δεν υπάρχει ήδη.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
// Δημιουργήστε ένα νέο βιβλίο εργασίας.
Workbook wb = new Workbook();
// Δημιουργήστε ένα αντικείμενο φύλλου εργασίας και αποκτήστε το πρώτο φύλλο.
Worksheet sheet = wb.Worksheets[0];
// Ορίστε το αντικείμενο στυλ.
Style style;
// Ορίστε το αντικείμενο σημαία στυλ.
StyleFlag flag;
// Κάντε βρόχο σε όλες τις στήλες του φύλλου εργασίας και ξεκλειδώστε τις.
for (int i = 0; i <= 255; i++)
{
    style = sheet.Cells.Columns[(byte)i].Style;
    style.IsLocked = false;
    flag = new StyleFlag();
    flag.Locked = true;
    sheet.Cells.Columns[(byte)i].ApplyStyle(style, flag);
}
// Αποκτήστε το στυλ πρώτης σειράς.
style = sheet.Cells.Rows[0].Style;
// Κλείδωσέ το.
style.IsLocked = true;
//Τοποθετήστε τη σημαία.
flag = new StyleFlag();
// Ρυθμίστε τη ρύθμιση κλειδώματος.
flag.Locked = true;
// Εφαρμόστε το στυλ στην πρώτη σειρά.
sheet.Cells.ApplyRowStyle(0, style, flag);
// Προστατέψτε το φύλλο.
sheet.Protect(ProtectionType.All);
// Αποθηκεύστε το αρχείο excel.
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```

## συμπέρασμα

Συγχαρητήρια ! Τώρα έχετε τον πηγαίο κώδικα C# που σας επιτρέπει να προστατεύετε σειρές σε ένα υπολογιστικό φύλλο Excel χρησιμοποιώντας τη βιβλιοθήκη Aspose.Cells για .NET. Φροντίστε να ακολουθήσετε προσεκτικά τα βήματα και να προσαρμόσετε τον κώδικα στις συγκεκριμένες ανάγκες σας.

### Συχνές ερωτήσεις (Συχνές ερωτήσεις)

#### Λειτουργεί αυτός ο κώδικας με πρόσφατες εκδόσεις του Excel;

Ναι, αυτός ο κώδικας λειτουργεί με πρόσφατες εκδόσεις του Excel, συμπεριλαμβανομένων αρχείων σε μορφή Excel 2010 και άνω.

#### Μπορώ να προστατεύσω μόνο συγκεκριμένες σειρές αντί για όλες τις σειρές στο φύλλο εργασίας;

Ναι, μπορείτε να τροποποιήσετε τον κώδικα για να καθορίσετε τις συγκεκριμένες σειρές που θέλετε να προστατεύσετε. Θα χρειαστεί να προσαρμόσετε τον βρόχο και τους δείκτες ανάλογα.

#### Πώς μπορώ να ξεκλειδώσω ξανά τις κλειδωμένες γραμμές;

 Μπορείτε να χρησιμοποιήσετε το`IsLocked` μέθοδος του`Style` αντικείμενο για να ορίσετε την τιμή`false` και ξεκλειδώστε τις σειρές.

#### Είναι δυνατή η προστασία πολλών φύλλων εργασίας στο ίδιο βιβλίο εργασίας του Excel;

Ναι, μπορείτε να επαναλάβετε τα βήματα της δημιουργίας ενός φύλλου εργασίας, της ρύθμισης του στυλ και της προστασίας για κάθε φύλλο εργασίας στο βιβλίο εργασίας.

#### Πώς μπορώ να αλλάξω τον κωδικό πρόσβασης προστασίας υπολογιστικού φύλλου;

 Μπορείτε να αλλάξετε τον κωδικό πρόσβασης χρησιμοποιώντας το`Protect` μέθοδο και ορίζοντας έναν νέο κωδικό πρόσβασης ως όρισμα.