---
title: إدراج صورة في تذييل الرأس
linktitle: إدراج صورة في تذييل الرأس
second_title: Aspose.Cells لمرجع .NET API
description: تعرف على كيفية إدراج صورة في رأس أو تذييل مستند Excel باستخدام Aspose.Cells لـ .NET. دليل خطوة بخطوة مع الكود المصدري في C#.
type: docs
weight: 60
url: /ar/net/excel-page-setup/insert-image-in-header-footer/
---
يمكن أن تكون القدرة على إدراج صورة في رأس أو تذييل مستند Excel مفيدة جدًا لتخصيص تقاريرك أو إضافة شعارات الشركة. في هذه المقالة، سنرشدك خطوة بخطوة لإدراج صورة في رأس أو تذييل مستند Excel باستخدام Aspose.Cells لـ .NET. سوف تتعلم كيفية تحقيق ذلك باستخدام كود مصدر C#.

## الخطوة 1: تهيئة البيئة

قبل البدء، تأكد من تثبيت Aspose.Cells for .NET على جهازك. قم أيضًا بإنشاء مشروع جديد في بيئة التطوير المفضلة لديك.

## الخطوة 2: استيراد المكتبات الضرورية

في ملف التعليمات البرمجية الخاص بك، قم باستيراد المكتبات اللازمة للعمل مع Aspose.Cells. هنا هو الكود المقابل:

```csharp
using Aspose.Cells;
```

## الخطوة 3: قم بتعيين دليل المستندات

قم بتعيين الدليل الذي يوجد به مستند Excel الذي تريد العمل معه. استخدم الكود التالي لتعيين الدليل:

```csharp
string dataDir = "YOUR DOCUMENTS DIRECTORY";
```

تأكد من تحديد مسار الدليل الكامل.

## الخطوة 4: إنشاء كائن مصنف

يمثل كائن المصنف مستند Excel الذي ستعمل معه. يمكنك إنشائه باستخدام الكود التالي:

```csharp
Workbook workbook = new Workbook();
```

يؤدي هذا إلى إنشاء كائن مصنف فارغ جديد.

## الخطوة 5: تخزين عنوان URL للصورة

حدد عنوان URL أو مسار الصورة التي تريد إدراجها في الرأس أو التذييل. استخدم الكود التالي لتخزين عنوان URL للصورة:

```csharp
string logo_url = dataDir + "aspose-logo.jpg";
```

تأكد من صحة المسار المحدد ومن وجود الصورة في ذلك الموقع.

## الخطوة 6: فتح ملف الصورة

لفتح ملف الصورة، سنستخدم كائن FileStream ونقرأ البيانات الثنائية من الصورة. هنا هو الكود المقابل:

```csharp
FileStream inFile;
byte[] binaryData;

inFile = new System.IO.FileStream(logo_url, System.IO.FileMode.Open, System.IO.FileAccess.Read);
binaryData = new Byte[inFile.Length];
long bytesRead = inFile.Read(binaryData, 0, (int)inFile.Length);
```

تأكد من صحة مسار الصورة وأن لديك الأذونات الصحيحة للوصول إليها.

## الخطوة 7: تكوين PageSetup

يتم استخدام كائن PageSetup لتعيين إعدادات صفحة مستند Excel بما في ذلك الرأس والتذييل. استخدم التعليمة البرمجية التالية للحصول على كائن PageSetup لورقة العمل الأولى:

```csharp
PageSetup pageSetup = workbook. Worksheets

[0].PageSetup;
```

سيسمح لك هذا بالوصول إلى إعدادات الصفحة لورقة العمل الأولى في المصنف.

## الخطوة 8: إضافة الصورة إلى الرأس

استخدم طريقة SetHeaderPicture() لكائن PageSetup لتعيين الصورة في القسم الأوسط من رأس الصفحة. هنا هو الكود المقابل:

```csharp
pageSetup.SetHeaderPicture(1, binaryData);
```

سيؤدي هذا إلى إضافة الصورة المحددة إلى رأس الصفحة.

## الخطوة 9: إضافة برنامج نصي إلى الرأس

لإضافة برنامج نصي إلى رأس الصفحة، استخدم الأسلوب SetHeader() للكائن PageSetup. هنا هو الكود المقابل:

```csharp
pageSetup.SetHeader(1, "&G");
```

سيؤدي هذا إلى إضافة البرنامج النصي المحدد إلى رأس الصفحة. في هذا المثال، يعرض البرنامج النصي "&G" رقم الصفحة.

## الخطوة 10: إضافة اسم الورقة إلى الرأس

لعرض اسم الورقة في رأس الصفحة، استخدم الأسلوب SetHeader() لكائن PageSetup مرة أخرى. هنا هو الكود المقابل:

```csharp
pageSetup.SetHeader(2, "&A");
```

سيؤدي هذا إلى إضافة اسم الورقة إلى رأس الصفحة. يتم استخدام البرنامج النصي "&A" لتمثيل اسم الورقة.

## الخطوة 11: حفظ المصنف

لحفظ التغييرات في المصنف، استخدم الأسلوب Save() لكائن المصنف. هنا هو الكود المقابل:

```csharp
workbook.Save(dataDir + "InsertImageInHeaderFooter_out.xls");
```

سيؤدي هذا إلى حفظ المصنف بالتغييرات التي تم إجراؤها على الدليل المحدد.

## الخطوة 12: إغلاق FileStream

بعد قراءة البيانات الثنائية من الصورة، تأكد من إغلاق FileStream لتحرير الموارد. استخدم الكود التالي لإغلاق FileStream:

```csharp
inFile.Close();
```

تأكد من إغلاق FileStreams دائمًا عند الانتهاء من استخدامها.

### نموذج التعليمات البرمجية المصدر لإدراج صورة في تذييل الرأس باستخدام Aspose.Cells لـ .NET 
```csharp
//المسار إلى دليل المستندات.
string dataDir = "YOUR DOCUMENT DIRECTORY";
//إنشاء كائن المصنف
Workbook workbook = new Workbook();
// إنشاء متغير سلسلة لتخزين عنوان url الخاص بالشعار/الصورة
string logo_url = dataDir + "aspose-logo.jpg";
// الإعلان عن كائن FileStream
FileStream inFile;
// الإعلان عن مجموعة بايت
byte[] binaryData;
// إنشاء مثيل لكائن FileStream لفتح الشعار/الصورة في الدفق
inFile = new System.IO.FileStream(logo_url, System.IO.FileMode.Open, System.IO.FileAccess.Read);
// إنشاء مثيل لمصفوفة البايت لحجم كائن FileStream
binaryData = new Byte[inFile.Length];
// يقرأ كتلة من البايتات من الدفق ويكتب البيانات في مخزن مؤقت محدد لمصفوفة البايت.
long bytesRead = inFile.Read(binaryData, 0, (int)inFile.Length);
// إنشاء كائن PageSetup للحصول على إعدادات الصفحة لورقة العمل الأولى في المصنف
PageSetup pageSetup = workbook.Worksheets[0].PageSetup;
// وضع الشعار/الصورة في القسم الأوسط من رأس الصفحة
pageSetup.SetHeaderPicture(1, binaryData);
// إعداد البرنامج النصي للشعار/الصورة
pageSetup.SetHeader(1, "&G");
// تعيين اسم الورقة في القسم الأيمن من رأس الصفحة باستخدام البرنامج النصي
pageSetup.SetHeader(2, "&A");
// حفظ المصنف
workbook.Save(dataDir + "InsertImageInHeaderFooter_out.xls");
//إغلاق كائن FileStream
inFile.Close();       
```
## خاتمة

تهنئة ! أنت تعرف الآن كيفية إدراج صورة في رأس أو تذييل مستند Excel باستخدام Aspose.Cells لـ .NET. يرشدك هذا البرنامج التعليمي خلال كل خطوة من خطوات العملية، بدءًا من إعداد البيئة وحتى حفظ المصنف المعدل. لا تتردد في تجربة المزيد من ميزات Aspose.Cells لإنشاء مستندات Excel مخصصة واحترافية.

### الأسئلة الشائعة

#### س1: هل من الممكن إدراج صور متعددة في رأس أو تذييل مستند Excel؟

A1: نعم، يمكنك إدراج صور متعددة في رأس أو تذييل مستند Excel عن طريق تكرار الخطوتين 8 و9 لكل صورة إضافية.

#### س2: ما هي تنسيقات الصور المدعومة للإدراج في الرأس أو التذييل؟
ج2: يدعم Aspose.Cells مجموعة متنوعة من تنسيقات الصور الشائعة مثل JPEG، وPNG، وGIF، وBMP، وما إلى ذلك.

#### س3: هل يمكنني تخصيص مظهر الرأس أو التذييل بشكل أكبر؟

ج3: نعم، يمكنك استخدام برامج نصية ورموز خاصة لمزيد من التنسيق وتخصيص مظهر الرأس أو التذييل. راجع وثائق Aspose.Cells للحصول على مزيد من المعلومات حول خيارات التخصيص.

#### س 4: هل يعمل Aspose.Cells مع إصدارات مختلفة من Excel؟

ج4: نعم، Aspose.Cells متوافق مع إصدارات مختلفة من Excel بما في ذلك Excel 2003 وExcel 2007 وExcel 2010 وExcel 2013 وExcel 2016 وExcel 2019.

#### س5: هل من الممكن إدراج صور في أجزاء أخرى من مستند Excel، مثل الخلايا أو المخططات؟

ج5: نعم، يوفر Aspose.Cells وظائف شاملة لإدراج الصور في أجزاء مختلفة من مستند Excel، بما في ذلك الخلايا والمخططات والكائنات الرسومية.