---
title: حماية ورقة عمل Excel
linktitle: حماية ورقة عمل Excel
second_title: Aspose.Cells لمرجع .NET API
description: اكتشف في هذا البرنامج التعليمي كيفية حماية جدول بيانات Excel باستخدام Aspose.Cells لـ .NET. دليل خطوة بخطوة في C#.
type: docs
weight: 50
url: /ar/net/protect-excel-file/protect-excel-worksheet/
---
في هذا البرنامج التعليمي، سنلقي نظرة على بعض التعليمات البرمجية المصدر لـ C# التي تستخدم مكتبة Aspose.Cells لحماية جدول بيانات Excel. سنتعرف على كل خطوة من خطوات الكود ونشرح كيفية عمله. تأكد من اتباع التعليمات بعناية للحصول على النتائج المرجوة.

## الخطوة 1: المتطلبات الأساسية

قبل البدء، تأكد من تثبيت مكتبة Aspose.Cells لـ .NET. يمكنك الحصول عليه من موقع Aspose الرسمي. تأكد أيضًا من أن لديك إصدارًا حديثًا من Visual Studio أو أي بيئة تطوير أخرى لـ C#.

## الخطوة 2: استيراد مساحات الأسماء المطلوبة

لاستخدام مكتبة Aspose.Cells، نحتاج إلى استيراد مساحات الأسماء الضرورية إلى الكود الخاص بنا. أضف الأسطر التالية إلى أعلى ملف مصدر C# الخاص بك:

```csharp
using Aspose.Cells;
using System.IO;
```

## الخطوة 3: قم بتحميل ملف Excel

في هذه الخطوة، سنقوم بتحميل ملف Excel الذي نريد حمايته. تأكد من تحديد المسار الصحيح للدليل الذي يحتوي على ملف Excel. استخدم الكود التالي لتحميل الملف:

```csharp
// المسار إلى دليل المستندات.
string dataDir = "YOUR_DIRECTORY_OF_DOCUMENTS";

// قم بإنشاء دفق من الملفات التي تحتوي على ملف Excel لفتحه.
FileStream fstream = new FileStream(dataDir + "book1.xls", FileMode.Open);

// إنشاء مثيل لكائن المصنف.
//افتح ملف Excel عبر دفق الملفات.
Workbook excel = new Workbook(fstream);
```

 تأكد من استبدال`"YOUR_DOCUMENTS_DIR"` بالمسار المناسب إلى دليل المستندات الخاص بك.

## الخطوة 4: الوصول إلى جدول البيانات

الآن وبعد أن قمنا بتحميل ملف Excel، يمكننا الوصول إلى ورقة العمل الأولى. استخدم الكود التالي للوصول إلى ورقة العمل الأولى:

```csharp
// الوصول إلى ورقة العمل الأولى في ملف Excel.
Worksheet worksheet = excel.Worksheets[0];
```

## الخطوة 5: حماية ورقة العمل

في هذه الخطوة، سنقوم بحماية جدول البيانات باستخدام كلمة مرور. استخدم الكود التالي لحماية جدول البيانات:

```csharp
// حماية ورقة العمل بكلمة مرور.
worksheet.Protect(ProtectionType.All, "YOUR_PASSWORD", null);
```

 يستبدل`"YOUR_PASSWORD"` بكلمة المرور التي تريد استخدامها لحماية جدول البيانات.

## الخطوة 6: احفظ ملف Excel المعدل الآن بعد أن قمنا بحماية

في جدول البيانات، سنقوم بحفظ ملف Excel المعدل بالتنسيق الافتراضي. استخدم الكود التالي لحفظ ملف Excel:

```csharp
// احفظ ملف Excel المعدل بالتنسيق الافتراضي.
excel.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```

تأكد من تحديد المسار الصحيح لحفظ ملف Excel المعدل.

## الخطوة 7: إغلاق دفق الملفات

لتحرير كافة الموارد، نحتاج إلى إغلاق دفق الملف المستخدم لتحميل ملف Excel. استخدم الكود التالي لإغلاق دفق الملف:

```csharp
// أغلق دفق الملف لتحرير جميع الموارد.
fstream.Close();
```

تأكد من تضمين هذه الخطوة في نهاية الكود الخاص بك.


### نموذج التعليمات البرمجية المصدر لحماية ورقة عمل Excel باستخدام Aspose.Cells لـ .NET 
```csharp
//المسار إلى دليل المستندات.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// إنشاء دفق ملف يحتوي على ملف Excel المراد فتحه
FileStream fstream = new FileStream(dataDir + "book1.xls", FileMode.Open);
// إنشاء مثيل لكائن المصنف
// فتح ملف Excel من خلال دفق الملف
Workbook excel = new Workbook(fstream);
// الوصول إلى ورقة العمل الأولى في ملف Excel
Worksheet worksheet = excel.Worksheets[0];
// حماية ورقة العمل بكلمة مرور
worksheet.Protect(ProtectionType.All, "aspose", null);
// حفظ ملف Excel المعدل بالتنسيق الافتراضي
excel.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
// إغلاق دفق الملف لتحرير كافة الموارد
fstream.Close();
```

## خاتمة

تهنئة ! لديك الآن كود مصدر C# الذي يسمح لك بحماية جدول بيانات Excel باستخدام مكتبة Aspose.Cells لـ .NET. تأكد من اتباع الخطوات بعناية وتخصيص الرمز وفقًا لاحتياجاتك المحددة.

### الأسئلة الشائعة (الأسئلة المتداولة)

#### هل من الممكن حماية أوراق عمل متعددة في ملف Excel واحد؟

ج: نعم، يمكنك حماية أوراق عمل متعددة في ملف Excel واحد عن طريق تكرار الخطوات من 4 إلى 6 لكل ورقة عمل.

#### كيف يمكنني تحديد أذونات محددة للمستخدمين المعتمدين؟

 ج: يمكنك استخدام الخيارات الإضافية التي يوفرها`Protect`طريقة لتحديد أذونات محددة للمستخدمين المعتمدين. راجع وثائق Aspose.Cells لمزيد من المعلومات.

#### هل يمكنني حماية ملف Excel نفسه بكلمة مرور؟

ج: نعم، يمكنك حماية ملف Excel نفسه بكلمة مرور باستخدام طرق أخرى توفرها مكتبة Aspose.Cells. يرجى الرجوع إلى الوثائق للحصول على أمثلة محددة.

#### هل تدعم مكتبة Aspose.Cells تنسيقات ملفات Excel الأخرى؟

ج: نعم، تدعم مكتبة Aspose.Cells نطاقًا واسعًا من تنسيقات ملفات Excel، بما في ذلك XLSX وXLSM وXLSB وCSV وما إلى ذلك.