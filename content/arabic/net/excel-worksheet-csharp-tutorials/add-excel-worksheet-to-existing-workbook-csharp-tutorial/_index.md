---
title: إضافة ورقة عمل Excel إلى المصنف الموجود في البرنامج التعليمي C#
linktitle: إضافة ورقة عمل Excel إلى المصنف الموجود
second_title: Aspose.Cells لمرجع .NET API
description: يمكنك بسهولة إضافة ورقة جديدة إلى مصنف Excel موجود باستخدام Aspose.Cells for .NET. البرنامج التعليمي خطوة بخطوة مع أمثلة التعليمات البرمجية.
type: docs
weight: 10
url: /ar/net/excel-worksheet-csharp-tutorials/add-excel-worksheet-to-existing-workbook-csharp-tutorial/
---
في هذا البرنامج التعليمي، سنأخذك خطوة بخطوة لشرح التعليمات البرمجية المصدر لـ C# أدناه، والتي تساعد على إضافة ورقة جديدة إلى مصنف Excel موجود باستخدام Aspose.Cells for .NET. سنقوم بتضمين نموذج التعليمات البرمجية لكل خطوة لمساعدتك على فهم العملية بالتفصيل.

## الخطوة 1: تحديد دليل المستندات

للبدء، تحتاج إلى تعيين مسار الدليل حيث يوجد ملف Excel الخاص بك. استبدل "دليل المستندات الخاص بك" في الكود بالمسار الفعلي لملف Excel الخاص بك.

```csharp
//المسار إلى دليل المستندات.
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## الخطوة 2: إنشاء دفق ملف وفتح ملف Excel

 بعد ذلك، تحتاج إلى إنشاء دفق ملف وفتح ملف Excel باستخدام الملف`FileStream` فصل.

```csharp
// قم بإنشاء دفق ملف يحتوي على ملف Excel لفتحه
FileStream fstream = new FileStream(dataDir + "book1.xls", FileMode.Open);
```

## الخطوة 3: إنشاء كائن مصنف

 بعد فتح ملف Excel، تحتاج إلى إنشاء مثيل`Workbook`هدف. يمثل هذا الكائن مصنف Excel ويوفر أساليب وخصائص متنوعة للتعامل مع المصنف.

```csharp
// إنشاء مثيل لكائن المصنف
// افتح ملف Excel عبر تدفق الملف
Workbook workbook = new Workbook(fstream);
```

## الخطوة 4: إضافة ورقة جديدة إلى المصنف

 لإضافة ورقة عمل جديدة إلى المصنف، يمكنك استخدام`Worksheets.Add()` طريقة`Workbook` هدف. تقوم هذه الطريقة بإرجاع فهرس الورقة المضافة حديثًا.

```csharp
// إضافة ورقة جديدة إلى مصنف المصنف
int i = workbook. Worksheets. Add();
```

## الخطوة 5: تعيين اسم الورقة الجديدة

 يمكنك تعيين اسم الورقة المضافة حديثًا باستخدام`Name` ملكية`Worksheet` هدف.

```csharp
// احصل على مرجع الورقة الجديدة المضافة عن طريق تمرير فهرس الورقة الخاص بها
Worksheet worksheet = workbook.Worksheets[i];
// تحديد اسم الورقة الجديدة
worksheet.Name = "My Worksheet";
```

## الخطوة 6: احفظ ملف Excel

 بمجرد إضافة الورقة الجديدة وتعيين اسمها، يمكنك حفظ ملف Excel المعدل باستخدام الملف`Save()` طريقة`Workbook` هدف.

```csharp
// احفظ ملف إكسل
workbook.Save(dataDir + "output.out.xls");
```

## الخطوة 7: أغلق تدفق الملفات وحرر الموارد

وأخيرًا، من المهم إغلاق دفق الملف لتحرير جميع الموارد المرتبطة به.

```csharp
// أغلق دفق الملف لتحرير جميع الموارد
fstream.Close();
```

### نموذج التعليمات البرمجية المصدر لبرنامج تعليمي لإضافة ورقة عمل Excel إلى المصنف الموجود C# باستخدام Aspose.Cells لـ .NET 
```csharp
//المسار إلى دليل المستندات.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// إنشاء دفق ملف يحتوي على ملف Excel المراد فتحه
FileStream fstream = new FileStream(dataDir + "book1.xls", FileMode.Open);
// إنشاء مثيل لكائن المصنف
// فتح ملف Excel من خلال دفق الملف
Workbook workbook = new Workbook(fstream);
// إضافة ورقة عمل جديدة إلى كائن المصنف
int i = workbook.Worksheets.Add();
// الحصول على مرجع ورقة العمل المضافة حديثاً عن طريق تمرير فهرس الورقة الخاص بها
Worksheet worksheet = workbook.Worksheets[i];
// تحديد اسم ورقة العمل المضافة حديثا
worksheet.Name = "My Worksheet";
// حفظ ملف اكسيل
workbook.Save(dataDir + "output.out.xls");
// إغلاق دفق الملف لتحرير كافة الموارد
fstream.Close();
```

## خاتمة

في هذا البرنامج التعليمي، قمنا بتغطية العملية خطوة بخطوة لإضافة اتصال جديد بمصنف Excel موجود باستخدام Aspose.Cells for .NET. باتباع أمثلة التعليمات البرمجية والشروحات المقدمة، يجب أن يكون لديك الآن فهم جيد لكيفية تنفيذ هذه المهمة في تطبيقات C# الخاصة بك. يوفر Aspose.Cells for .NET مجموعة شاملة من الميزات للعمل مع ملفات Excel، مما يسمح لك بأتمتة المهام المختلفة المتعلقة بـ Excel بكفاءة.

### أسئلة وأجوبة (FAQ)

#### ما هو Aspose.Cells لـ .NET؟

Aspose.Cells for .NET هي مكتبة .NET قوية تسمح للمطورين بإنشاء ملفات Excel ومعالجتها وتحويلها في تطبيقاتهم. فهو يقدم مجموعة واسعة من الميزات للعمل مع جداول البيانات والخلايا والصيغ والأنماط والمزيد.

#### كيف يمكنني تثبيت Aspose.Cells لـ .NET؟

لتثبيت Aspose.Cells لـ .NET، يمكنك تنزيل حزمة التثبيت من إصدارات Aspose (https://releases.aspose.com/cells/net) واتبع تعليمات التثبيت المتوفرة. ستحتاج أيضًا إلى ترخيص صالح لاستخدام المكتبة في تطبيقاتك.

#### هل يمكنني إضافة جداول بيانات متعددة باستخدام Aspose.Cells لـ .NET؟

 نعم، يمكنك إضافة أوراق عمل متعددة إلى ملف Excel واحد باستخدام Aspose.Cells لـ .NET. يمكنك استخدام ال`Worksheets.Add()` طريقة`Workbook` كائن لإضافة أوراق عمل جديدة في مواضع مختلفة في المصنف.

#### كيف يمكنني تنسيق الخلايا في ملف Excel؟

يوفر Aspose.Cells for .NET أساليب وخصائص مختلفة لتنسيق الخلايا في ملف Excel. يمكنك تعيين قيم الخلايا وتطبيق خيارات التنسيق مثل نمط الخط واللون والمحاذاة والحدود والمزيد. راجع الوثائق ونموذج التعليمات البرمجية المقدم من Aspose.Cells للحصول على معلومات أكثر تفصيلاً حول تنسيق الخلايا.

#### هل يتوافق Aspose.Cells for .NET مع الإصدارات المختلفة من Excel؟

نعم، يتوافق Aspose.Cells for .NET مع إصدارات مختلفة من Excel بما في ذلك Excel 2003 وExcel 2007 وExcel 2010 وExcel 2013 وExcel 2016 وExcel 2019 وExcel لـ Office 365. وهو يدعم كلاً من التنسيق .xls والأحدث. تنسيق xlsx.