---
title: ตั้งค่าส่วนหัวและส่วนท้ายของ Excel
linktitle: ตั้งค่าส่วนหัวและส่วนท้ายของ Excel
second_title: Aspose.Cells สำหรับการอ้างอิง .NET API
description: เรียนรู้วิธีการตั้งค่าส่วนหัวและส่วนท้ายใน Excel โดยใช้ Aspose.Cells สำหรับ .NET
type: docs
weight: 100
url: /th/net/excel-page-setup/set-excel-headers-and-footers/
---

ในบทช่วยสอนนี้ เราจะแสดงให้คุณเห็นวิธีตั้งค่าส่วนหัวและส่วนท้ายใน Excel ทีละขั้นตอนโดยใช้ Aspose.Cells สำหรับ .NET เราจะใช้ซอร์สโค้ด C# เพื่อแสดงกระบวนการ

## ขั้นตอนที่ 1: การตั้งค่าสภาพแวดล้อม

ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Aspose.Cells สำหรับ .NET บนเครื่องของคุณแล้ว สร้างโปรเจ็กต์ใหม่ในสภาพแวดล้อมการพัฒนาที่คุณต้องการ

## ขั้นตอนที่ 2: นำเข้าไลบรารีที่จำเป็น

ในไฟล์โค้ดของคุณ ให้นำเข้าไลบรารีที่จำเป็นในการทำงานกับ Aspose.Cells นี่คือรหัสที่เกี่ยวข้อง:

```csharp
using Aspose.Cells;
```

## ขั้นตอนที่ 3: ตั้งค่าไดเร็กทอรีข้อมูล

ตั้งค่าไดเร็กทอรีข้อมูลที่คุณต้องการบันทึกไฟล์ Excel ที่แก้ไข ใช้รหัสต่อไปนี้:

```csharp
string dataDir = "YOUR DATA DIRECTORY";
```

อย่าลืมระบุเส้นทางไดเรกทอรีแบบเต็ม

## ขั้นตอนที่ 4: การสร้างสมุดงานและแผ่นงาน

สร้างวัตถุสมุดงานใหม่และนำทางไปยังแผ่นงานแรกในสมุดงานโดยใช้รหัสต่อไปนี้:

```csharp
Workbook excel = new Workbook();
PageSetup pageSetup = excel.Worksheets[0].PageSetup;
```

ซึ่งจะสร้างเวิร์กบุ๊กว่างพร้อมเวิร์กชีทและให้สิทธิ์เข้าถึงออบเจ็กต์ PageSetup ของเวิร์กชีตนั้น

## ขั้นตอนที่ 5: การตั้งค่าส่วนหัว

 ตั้งค่าส่วนหัวของสเปรดชีตโดยใช้`SetHeader` วิธีการของวัตถุ PageSetup นี่คือโค้ดตัวอย่าง:

```csharp
pageSetup.SetHeader(0, "&A");
pageSetup.SetHeader(1, "&\"Times New Roman,Bold\"&D-&T");
pageSetup.SetHeader(2, "&\"Times New Roman,Bold\"&12&F");
```

ซึ่งจะตั้งชื่อเวิร์กชีท วันที่และเวลาปัจจุบัน และชื่อไฟล์ในส่วนหัวตามลำดับ

## ขั้นตอนที่ 6: การกำหนดส่วนท้าย

 ตั้งค่าส่วนท้ายของสเปรดชีตโดยใช้`SetFooter` วิธีการของวัตถุ PageSetup นี่คือโค้ดตัวอย่าง:

```csharp
pageSetup.SetFooter(0, "Hello World! &\"Courier New\"&14 123");
pageSetup.SetFooter(1, "&P");
pageSetup.SetFooter(2, "&N");
```

ซึ่งจะตั้งค่าสตริงข้อความ หมายเลขหน้าปัจจุบัน และจำนวนหน้าทั้งหมดในส่วนท้ายตามลำดับ

## ขั้นตอนที่ 7: บันทึกสมุดงานที่แก้ไข

บันทึกสมุดงานที่แก้ไขโดยใช้รหัสต่อไปนี้:

```csharp
excel.Save(dataDir + "OutputFileName.xls");
```

วิธีนี้จะบันทึกสมุดงานที่แก้ไขลงในไดเร็กทอรีข้อมูลที่ระบุ

### ตัวอย่างซอร์สโค้ดสำหรับตั้งค่าส่วนหัวและส่วนท้ายของ Excel โดยใช้ Aspose.Cells สำหรับ .NET 
```csharp
//เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";
// การสร้างอินสแตนซ์วัตถุสมุดงาน
Workbook excel = new Workbook();
// การรับการอ้างอิงของ PageSetup ของแผ่นงาน
PageSetup pageSetup = excel.Worksheets[0].PageSetup;
// การตั้งชื่อแผ่นงานทางด้านซ้ายของส่วนหัว
pageSetup.SetHeader(0, "&A");
//การตั้งค่าวันที่และเวลาปัจจุบันที่ส่วนกลางของส่วนหัว
// และการเปลี่ยนแบบอักษรของส่วนหัว
pageSetup.SetHeader(1, "&\"Times New Roman,Bold\"&D-&T");
// ตั้งชื่อไฟล์ปัจจุบันที่ส่วนด้านขวาของส่วนหัวและเปลี่ยน
// แบบอักษรของส่วนหัว
pageSetup.SetHeader(2, "&\"Times New Roman,Bold\"&12&F");
// การตั้งค่าสตริงที่ส่วนด้านซ้ายของส่วนท้ายและการเปลี่ยนแบบอักษร
// ของส่วนหนึ่งของสตริงนี้ ("123")
pageSetup.SetFooter(0, "Hello World! &\"Courier New\"&14 123");
// การตั้งค่าหมายเลขหน้าปัจจุบันที่ส่วนกลางของส่วนท้าย
pageSetup.SetFooter(1, "&P");
// การตั้งค่าการนับหน้าที่ส่วนด้านขวาของส่วนท้าย
pageSetup.SetFooter(2, "&N");
// บันทึกสมุดงาน
excel.Save(dataDir + "SetHeadersAndFooters_out.xls");
```


## บทสรุป

ตอนนี้คุณได้เรียนรู้วิธีการตั้งค่าส่วนหัวและส่วนท้ายใน Excel โดยใช้ Aspose.Cells สำหรับ .NET แล้ว บทช่วยสอนนี้จะอธิบายคุณตลอดทุกขั้นตอนของกระบวนการ ตั้งแต่การตั้งค่าสภาพแวดล้อมไปจนถึงการบันทึกเวิร์กบุ๊กที่แก้ไข อย่าลังเลที่จะสำรวจฟีเจอร์ของ Aspose.Cells เพิ่มเติมเพื่อดำเนินการปรับแต่งเพิ่มเติมในไฟล์ Excel ของคุณ

### คำถามที่พบบ่อย (FAQ)

#### 1. ฉันจะติดตั้ง Aspose.Cells สำหรับ .NET บนระบบของฉันได้อย่างไร
หากต้องการติดตั้ง Aspose.Cells สำหรับ .NET คุณต้องดาวน์โหลดแพ็คเกจการติดตั้งจากเว็บไซต์อย่างเป็นทางการของ Aspose และทำตามคำแนะนำที่ให้ไว้ในเอกสารประกอบ

#### 2. วิธีนี้ใช้ได้กับ Excel ทุกเวอร์ชันหรือไม่
ใช่ วิธีการตั้งค่าส่วนหัวและส่วนท้ายด้วย Aspose.Cells สำหรับ .NET ทำงานได้กับ Excel เวอร์ชันที่รองรับทั้งหมด

#### 3. ฉันสามารถปรับแต่งส่วนหัวและส่วนท้ายเพิ่มเติมได้หรือไม่
ใช่ Aspose.Cells นำเสนอคุณสมบัติที่หลากหลายเพื่อปรับแต่งส่วนหัวและส่วนท้าย รวมถึงการวางข้อความ สี แบบอักษร หมายเลขหน้า และอื่นๆ

#### 4. ฉันจะเพิ่มข้อมูลแบบไดนามิกให้กับส่วนหัวและส่วนท้ายได้อย่างไร?
คุณสามารถใช้ตัวแปรพิเศษและโค้ดการจัดรูปแบบเพื่อเพิ่มข้อมูลแบบไดนามิก เช่น วันที่ เวลา ปัจจุบัน ชื่อไฟล์ หมายเลขหน้า ฯลฯ ลงในส่วนหัวและส่วนท้าย

#### 5. ฉันสามารถลบส่วนหัวและส่วนท้ายหลังจากตั้งค่าแล้วได้หรือไม่
 ใช่ คุณสามารถลบส่วนหัวและส่วนท้ายได้โดยใช้`ClearHeaderFooter` วิธีการของ`PageSetup` วัตถุ. การดำเนินการนี้จะคืนค่าส่วนหัวและส่วนท้ายเริ่มต้น