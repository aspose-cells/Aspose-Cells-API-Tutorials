---
title: แทรกรูปภาพในส่วนท้ายของส่วนหัว
linktitle: แทรกรูปภาพในส่วนท้ายของส่วนหัว
second_title: Aspose.Cells สำหรับการอ้างอิง .NET API
description: เรียนรู้วิธีแทรกรูปภาพลงในส่วนหัวหรือส่วนท้ายของเอกสาร Excel โดยใช้ Aspose.Cells สำหรับ .NET คำแนะนำทีละขั้นตอนพร้อมซอร์สโค้ดใน C#
type: docs
weight: 60
url: /th/net/excel-page-setup/insert-image-in-header-footer/
---
ความสามารถในการแทรกรูปภาพในส่วนหัวหรือส่วนท้ายของเอกสาร Excel จะมีประโยชน์อย่างมากในการปรับแต่งรายงานหรือเพิ่มโลโก้บริษัท ในบทความนี้ เราจะแนะนำคุณทีละขั้นตอนในการแทรกรูปภาพในส่วนหัวหรือส่วนท้ายของเอกสาร Excel โดยใช้ Aspose.Cells for .NET คุณจะได้เรียนรู้วิธีการทำสิ่งนี้ให้สำเร็จโดยใช้ซอร์สโค้ด C#

## ขั้นตอนที่ 1: การตั้งค่าสภาพแวดล้อม

ก่อนที่คุณจะเริ่มต้น ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Aspose.Cells สำหรับ .NET บนเครื่องของคุณแล้ว สร้างโปรเจ็กต์ใหม่ในสภาพแวดล้อมการพัฒนาที่คุณต้องการ

## ขั้นตอนที่ 2: นำเข้าไลบรารีที่จำเป็น

ในไฟล์โค้ดของคุณ ให้นำเข้าไลบรารีที่จำเป็นในการทำงานกับ Aspose.Cells นี่คือรหัสที่เกี่ยวข้อง:

```csharp
using Aspose.Cells;
```

## ขั้นตอนที่ 3: ตั้งค่าไดเรกทอรีเอกสาร

ตั้งค่าไดเร็กทอรีที่มีเอกสาร Excel ที่คุณต้องการใช้งาน ใช้รหัสต่อไปนี้เพื่อตั้งค่าไดเร็กทอรี:

```csharp
string dataDir = "YOUR DOCUMENTS DIRECTORY";
```

อย่าลืมระบุเส้นทางไดเรกทอรีแบบเต็ม

## ขั้นตอนที่ 4: การสร้างวัตถุสมุดงาน

วัตถุสมุดงานแสดงถึงเอกสาร Excel ที่คุณจะใช้งาน คุณสามารถสร้างมันขึ้นมาได้โดยใช้รหัสต่อไปนี้:

```csharp
Workbook workbook = new Workbook();
```

ซึ่งจะสร้างวัตถุสมุดงานเปล่าใหม่

## ขั้นตอนที่ 5: การจัดเก็บ URL รูปภาพ

กำหนด URL หรือเส้นทางของรูปภาพที่คุณต้องการแทรกในส่วนหัวหรือส่วนท้าย ใช้รหัสต่อไปนี้เพื่อจัดเก็บ URL รูปภาพ:

```csharp
string logo_url = dataDir + "aspose-logo.jpg";
```

ตรวจสอบให้แน่ใจว่าเส้นทางที่ระบุถูกต้องและมีรูปภาพอยู่ในตำแหน่งนั้น

## ขั้นตอนที่ 6: การเปิดไฟล์รูปภาพ

หากต้องการเปิดไฟล์รูปภาพ เราจะใช้วัตถุ FileStream และอ่านข้อมูลไบนารีจากรูปภาพ นี่คือรหัสที่เกี่ยวข้อง:

```csharp
FileStream inFile;
byte[] binaryData;

inFile = new System.IO.FileStream(logo_url, System.IO.FileMode.Open, System.IO.FileAccess.Read);
binaryData = new Byte[inFile.Length];
long bytesRead = inFile.Read(binaryData, 0, (int)inFile.Length);
```

ตรวจสอบให้แน่ใจว่าเส้นทางรูปภาพถูกต้องและคุณมีสิทธิ์ที่ถูกต้องในการเข้าถึง

## ขั้นตอนที่ 7: การกำหนดค่า PageSetup

ออบเจ็กต์ PageSetup ใช้เพื่อตั้งค่าหน้าเอกสาร Excel รวมถึงส่วนหัวและส่วนท้าย ใช้รหัสต่อไปนี้เพื่อรับวัตถุ PageSetup ของแผ่นงานแรก:

```csharp
PageSetup pageSetup = workbook. Worksheets

[0].PageSetup;
```

ซึ่งจะช่วยให้คุณสามารถเข้าถึงการตั้งค่าหน้าสำหรับแผ่นงานแรกในสมุดงานได้

## ขั้นตอนที่ 8: การเพิ่มรูปภาพลงในส่วนหัว

ใช้เมธอด SetHeaderPicture() ของวัตถุ PageSetup เพื่อตั้งค่ารูปภาพในส่วนตรงกลางของส่วนหัวของหน้า นี่คือรหัสที่เกี่ยวข้อง:

```csharp
pageSetup.SetHeaderPicture(1, binaryData);
```

นี่จะเป็นการเพิ่มรูปภาพที่ระบุลงในส่วนหัวของหน้า

## ขั้นตอนที่ 9: การเพิ่มสคริปต์ที่ส่วนหัว

เมื่อต้องการเพิ่มสคริปต์ที่ส่วนหัวของหน้า ให้ใช้เมธอด SetHeader() ของวัตถุ PageSetup นี่คือรหัสที่เกี่ยวข้อง:

```csharp
pageSetup.SetHeader(1, "&G");
```

นี่จะเป็นการเพิ่มสคริปต์ที่ระบุลงในส่วนหัวของหน้า ในตัวอย่างนี้ สคริปต์ "&G" จะแสดงหมายเลขหน้า

## ขั้นตอนที่ 10: เพิ่มชื่อชีตลงในส่วนหัว

เมื่อต้องการแสดงชื่อแผ่นงานในส่วนหัวของหน้า ให้ใช้เมธอด SetHeader() ของวัตถุ PageSetup อีกครั้ง นี่คือรหัสที่เกี่ยวข้อง:

```csharp
pageSetup.SetHeader(2, "&A");
```

นี่จะเป็นการเพิ่มชื่อแผ่นงานลงในส่วนหัวของหน้า สคริปต์ "&A" ใช้เพื่อแสดงชื่อแผ่นงาน

## ขั้นตอนที่ 11: บันทึกสมุดงาน

หากต้องการบันทึกการเปลี่ยนแปลงในสมุดงาน ให้ใช้เมธอด Save() ของวัตถุสมุดงาน นี่คือรหัสที่เกี่ยวข้อง:

```csharp
workbook.Save(dataDir + "InsertImageInHeaderFooter_out.xls");
```

วิธีนี้จะบันทึกสมุดงานพร้อมกับการเปลี่ยนแปลงในไดเร็กทอรีที่ระบุ

## ขั้นตอนที่ 12: การปิด FileStream

หลังจากอ่านข้อมูลไบนารี่จากรูปภาพแล้ว อย่าลืมปิด FileStream เพื่อเพิ่มทรัพยากร ใช้รหัสต่อไปนี้เพื่อปิด FileStream:

```csharp
inFile.Close();
```

อย่าลืมปิด FileStreams เสมอเมื่อคุณใช้งานเสร็จแล้ว

### ตัวอย่างซอร์สโค้ดสำหรับการแทรกรูปภาพในส่วนท้ายของส่วนหัวโดยใช้ Aspose.Cells สำหรับ .NET 
```csharp
//เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";
//การสร้างวัตถุสมุดงาน
Workbook workbook = new Workbook();
// การสร้างตัวแปรสตริงเพื่อจัดเก็บ URL ของโลโก้/รูปภาพ
string logo_url = dataDir + "aspose-logo.jpg";
// ประกาศวัตถุ FileStream
FileStream inFile;
// การประกาศอาร์เรย์ไบต์
byte[] binaryData;
// การสร้างอินสแตนซ์ของวัตถุ FileStream เพื่อเปิดโลโก้/รูปภาพในสตรีม
inFile = new System.IO.FileStream(logo_url, System.IO.FileMode.Open, System.IO.FileAccess.Read);
// การสร้างอินสแตนซ์อาร์เรย์ไบต์ของขนาดของวัตถุ FileStream
binaryData = new Byte[inFile.Length];
// อ่านบล็อกไบต์จากสตรีมและเขียนข้อมูลในบัฟเฟอร์ที่กำหนดของอาร์เรย์ไบต์
long bytesRead = inFile.Read(binaryData, 0, (int)inFile.Length);
// การสร้างวัตถุ PageSetup เพื่อรับการตั้งค่าหน้าของแผ่นงานแรกของสมุดงาน
PageSetup pageSetup = workbook.Worksheets[0].PageSetup;
// การตั้งค่าโลโก้/รูปภาพในส่วนกลางของส่วนหัวของหน้า
pageSetup.SetHeaderPicture(1, binaryData);
// การตั้งค่าสคริปต์สำหรับโลโก้/รูปภาพ
pageSetup.SetHeader(1, "&G");
// การตั้งชื่อชีตในส่วนด้านขวาของส่วนหัวของหน้าด้วยสคริปต์
pageSetup.SetHeader(2, "&A");
// กำลังบันทึกสมุดงาน
workbook.Save(dataDir + "InsertImageInHeaderFooter_out.xls");
//การปิดวัตถุ FileStream
inFile.Close();       
```
## บทสรุป

ขอแสดงความยินดี! ตอนนี้คุณรู้วิธีแทรกรูปภาพในส่วนหัวหรือส่วนท้ายของเอกสาร Excel โดยใช้ Aspose.Cells สำหรับ .NET แล้ว บทช่วยสอนนี้จะอธิบายคุณตลอดทุกขั้นตอนของกระบวนการ ตั้งแต่การตั้งค่าสภาพแวดล้อมไปจนถึงการบันทึกเวิร์กบุ๊กที่แก้ไข อย่าลังเลที่จะทดลองเพิ่มเติมด้วยฟีเจอร์ของ Aspose.Cells เพื่อสร้างเอกสาร Excel ที่เป็นส่วนตัวและเป็นมืออาชีพ

### คำถามที่พบบ่อย

#### คำถามที่ 1: เป็นไปได้ไหมที่จะแทรกรูปภาพหลายรูปในส่วนหัวหรือส่วนท้ายของเอกสาร Excel

A1: ได้ คุณสามารถแทรกรูปภาพหลายรูปลงในส่วนหัวหรือส่วนท้ายของเอกสาร Excel ได้โดยทำซ้ำขั้นตอนที่ 8 และ 9 สำหรับรูปภาพเพิ่มเติมแต่ละรูป

#### คำถามที่ 2: รูปแบบรูปภาพใดบ้างที่รองรับการแทรกในส่วนหัวหรือส่วนท้าย
A2: Aspose.Cells รองรับรูปแบบรูปภาพทั่วไปที่หลากหลาย เช่น JPEG, PNG, GIF, BMP เป็นต้น

#### คำถามที่ 3: ฉันสามารถปรับแต่งลักษณะที่ปรากฏของส่วนหัวหรือส่วนท้ายเพิ่มเติมได้หรือไม่

A3: ได้ คุณสามารถใช้สคริปต์และรหัสพิเศษเพื่อจัดรูปแบบเพิ่มเติมและปรับแต่งลักษณะที่ปรากฏของส่วนหัวหรือส่วนท้ายได้ โปรดดูเอกสารประกอบของ Aspose.Cells สำหรับข้อมูลเพิ่มเติมเกี่ยวกับตัวเลือกการปรับแต่ง

#### คำถามที่ 4: Aspose.Cells ทำงานร่วมกับ Excel เวอร์ชันต่างๆ ได้หรือไม่

A4: ใช่ Aspose.Cells เข้ากันได้กับ Excel เวอร์ชันต่างๆ รวมถึง Excel 2003, Excel 2007, Excel 2010, Excel 2013, Excel 2016 และ Excel 2019

#### คำถามที่ 5: เป็นไปได้ไหมที่จะแทรกรูปภาพในส่วนอื่นๆ ของเอกสาร Excel เช่น เซลล์หรือแผนภูมิ

A5: ใช่ Aspose.Cells มีฟังก์ชันการทำงานที่ครอบคลุมสำหรับการแทรกรูปภาพไปยังส่วนต่างๆ ของเอกสาร Excel รวมถึงเซลล์ แผนภูมิ และวัตถุรูปวาด