---
title: แก้ไขช่วงในแผ่นงาน Excel
linktitle: แก้ไขช่วงในแผ่นงาน Excel
second_title: Aspose.Cells สำหรับการอ้างอิง .NET API
description: เรียนรู้วิธีแก้ไขช่วงเฉพาะในสเปรดชีต Excel ด้วย Aspose.Cells สำหรับ .NET บทช่วยสอนทีละขั้นตอนใน C#
type: docs
weight: 20
url: /th/net/protect-excel-file/edit-ranges-in-excel-worksheet/
---
Microsoft Excel เป็นเครื่องมืออันทรงพลังสำหรับการสร้างและจัดการสเปรดชีต ซึ่งมีฟีเจอร์มากมายในการควบคุมและรักษาความปลอดภัยข้อมูล คุณสมบัติอย่างหนึ่งคือการอนุญาตให้ผู้ใช้สามารถแก้ไขช่วงเฉพาะในเวิร์กชีตพร้อมทั้งปกป้องส่วนอื่นๆ ไปด้วย ในบทช่วยสอนนี้ เราจะแนะนำคุณทีละขั้นตอนในการใช้ฟังก์ชันนี้โดยใช้ Aspose.Cells สำหรับ .NET ซึ่งเป็นไลบรารียอดนิยมสำหรับการทำงานกับไฟล์ Excel โดยทางโปรแกรม

การใช้ Aspose.Cells สำหรับ .NET จะช่วยให้คุณจัดการช่วงในสเปรดชีต Excel ได้อย่างง่ายดาย โดยมีอินเทอร์เฟซที่เป็นมิตรต่อผู้ใช้และคุณลักษณะขั้นสูง ทำตามขั้นตอนด้านล่างเพื่อให้ผู้ใช้สามารถแก้ไขช่วงเฉพาะในสเปรดชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET
## ขั้นตอนที่ 1: การตั้งค่าสภาพแวดล้อม

ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง Aspose.Cells สำหรับ .NET ในสภาพแวดล้อมการพัฒนาของคุณ ดาวน์โหลดไลบรารีจากเว็บไซต์อย่างเป็นทางการของ Aspose และตรวจสอบเอกสารประกอบเพื่อดูคำแนะนำในการติดตั้ง

## ขั้นตอนที่ 2: การเริ่มต้นสมุดงานและแผ่นงาน

ในการเริ่มต้น เราต้องสร้างสมุดงานใหม่และได้รับการอ้างอิงไปยังแผ่นงานที่เราต้องการให้มีการเปลี่ยนแปลงช่วง ใช้รหัสต่อไปนี้เพื่อให้บรรลุสิ่งนี้:

```csharp
// พาธไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENTS DIRECTORY";
// สร้างไดเร็กทอรีหากไม่มีอยู่
bool exists = System.IO.Directory.Exists(dataDir);
if (! exists)
     System.IO.Directory.CreateDirectory(dataDir);

// สร้างอินสแตนซ์เวิร์กบุ๊กใหม่
Workbook workbook = new Workbook();

// รับแผ่นงานแรก (ค่าเริ่มต้น)
Worksheet sheet = workbook.Worksheets[0];
```

 ในข้อมูลโค้ดนี้ ขั้นแรกเราจะกำหนดเส้นทางไปยังไดเร็กทอรีที่จะบันทึกไฟล์ Excel ต่อไป เราจะสร้างอินสแตนซ์ใหม่ของ`Workbook` คลาสและรับการอ้างอิงไปยังแผ่นงานแรกโดยใช้`Worksheets` คุณสมบัติ.

## ขั้นตอนที่ 3: รับช่วงที่แก้ไขได้

ตอนนี้เราจำเป็นต้องดึงข้อมูลช่วงที่เราต้องการอนุญาตให้แก้ไข ใช้รหัสต่อไปนี้:

```csharp
// รับช่วงที่ปรับเปลี่ยนได้
ProtectedRangeCollection EditableRanges = Sheet.AllowEditRanges;
```

## ขั้นตอนที่ 4: ตั้งค่าช่วงที่ได้รับการป้องกัน

ก่อนที่จะอนุญาตให้แก้ไขช่วง เราจำเป็นต้องกำหนดช่วงที่ได้รับการป้องกันก่อน มีวิธีดังนี้:

```csharp
// กำหนดช่วงที่มีการป้องกัน
ProtectedRange ProtectedRange;

// สร้างช่วง
int index = ModifiableRanges.Add("r2", 1, 1, 3, 3);
rangeProtected = rangesEditable[index];
```

 ในโค้ดนี้ เราจะสร้างอินสแตนซ์ใหม่ของ`ProtectedRange` คลาสและใช้`Add` วิธีการระบุช่วงที่จะป้องกัน

## ขั้นตอนที่ 5: ระบุรหัสผ่าน

เพื่อเพิ่มความปลอดภัย คุณสามารถระบุรหัสผ่านสำหรับช่วงที่ได้รับการป้องกันได้ มีวิธีดังนี้:

```csharp
// ระบุรหัสผ่าน
protectedBeach.Password = "YOUR_PASSWORD";
```

## ขั้นตอนที่ 6: ป้องกันแผ่นงาน

ตอนนี้เราได้กำหนดช่วงที่มีการป้องกันแล้ว เราสามารถป้องกันแผ่นงานเพื่อป้องกันการแก้ไขโดยไม่ได้รับอนุญาตได้ ใช้รหัสต่อไปนี้:

```csharp
// ป้องกันแผ่นงาน
leaf.Protect(ProtectionType.All);
```

## ขั้นตอนที่ 7: บันทึกไฟล์ Excel

สุดท้าย เราจะบันทึกไฟล์ Excel เมื่อมีการเปลี่ยนแปลง นี่คือรหัสที่จำเป็น:

```csharp
// บันทึกไฟล์ Excel
workbook.Save(dataDir + "protectedrange.out.xls");
```

### ซอร์สโค้ดตัวอย่างสำหรับการแก้ไขช่วงในแผ่นงาน Excel โดยใช้ Aspose.Cells สำหรับ .NET 
```csharp
//เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";
// สร้างไดเร็กทอรีหากไม่มีอยู่
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);

// สร้างอินสแตนซ์ของสมุดงานใหม่
Workbook book = new Workbook();

// รับแผ่นงานแรก (ค่าเริ่มต้น)
Worksheet sheet = book.Worksheets[0];

// รับช่วงที่อนุญาตการแก้ไข
ProtectedRangeCollection allowRanges = sheet.AllowEditRanges;

// กำหนด ProtectedRange
ProtectedRange proteced_range;

// สร้างช่วง
int idx = allowRanges.Add("r2", 1, 1, 3, 3);
proteced_range = allowRanges[idx];

// ระบุรหัสผ่าน
proteced_range.Password = "YOUR_PASSWORD";

// ป้องกันแผ่น
sheet.Protect(ProtectionType.All);

// บันทึกไฟล์ Excel
book.Save(dataDir + "protectedrange.out.xls");
```

## บทสรุป

ขอแสดงความยินดี! คุณได้เรียนรู้วิธีอนุญาตให้ผู้ใช้แก้ไขช่วงเฉพาะในสเปรดชีต Excel โดยใช้ Aspose.Cells สำหรับ .NET ตอนนี้คุณสามารถใช้เทคนิคนี้ในโครงการของคุณเองและปรับปรุงความปลอดภัยของไฟล์ Excel ของคุณได้


#### คำถามที่พบบ่อย

#### ถาม: เหตุใดฉันจึงควรใช้ Aspose.Cells สำหรับ .NET เพื่อแก้ไขช่วงในสเปรดชีต Excel

ตอบ: Aspose.Cells for .NET มี API ที่ทรงพลังและใช้งานง่ายสำหรับการทำงานกับไฟล์ Excel โดยมีคุณสมบัติขั้นสูง เช่น การจัดการช่วง การป้องกันแผ่นงาน ฯลฯ

#### ถาม: ฉันสามารถตั้งค่าช่วงที่แก้ไขได้หลายช่วงในเวิร์กชีตเดียวได้หรือไม่

 ตอบ: ได้ คุณสามารถกำหนดช่วงที่แก้ไขได้หลายช่วงโดยใช้`Add` วิธีการของ`ProtectedRangeCollection` ของสะสม. แต่ละช่วงสามารถมีการตั้งค่าการป้องกันของตัวเองได้

####  ถาม: เป็นไปได้ไหมที่จะลบช่วงที่แก้ไขได้หลังจากกำหนดแล้ว

 ตอบ: ได้ คุณสามารถใช้`RemoveAt` วิธีการของ`ProtectedRangeCollection` คอลเลกชันเพื่อลบช่วงที่แก้ไขได้เฉพาะโดยการระบุดัชนี

#### ถาม: ฉันจะเปิดไฟล์ Excel ที่ได้รับการป้องกันหลังจากบันทึกได้อย่างไร

ตอบ: คุณจะต้องระบุรหัสผ่านที่ระบุเมื่อสร้างช่วงที่มีการป้องกันเพื่อเปิดไฟล์ Excel ที่ได้รับการป้องกัน อย่าลืมเก็บรหัสผ่านไว้ในที่ปลอดภัยเพื่อป้องกันการสูญเสียการเข้าถึงข้อมูล