---
title: ป้องกันแผ่นงาน Excel
linktitle: ป้องกันแผ่นงาน Excel
second_title: Aspose.Cells สำหรับการอ้างอิง .NET API
description: ค้นพบวิธีการปกป้องสเปรดชีต Excel โดยใช้ Aspose.Cells for .NET ในบทช่วยสอนนี้ คำแนะนำทีละขั้นตอนใน C#
type: docs
weight: 50
url: /th/net/protect-excel-file/protect-excel-worksheet/
---
ในบทช่วยสอนนี้ เราจะดูซอร์สโค้ด C# บางส่วนที่ใช้ไลบรารี Aspose.Cells เพื่อปกป้องสเปรดชีต Excel เราจะอธิบายแต่ละขั้นตอนของโค้ดและอธิบายวิธีการทำงาน อย่าลืมปฏิบัติตามคำแนะนำอย่างระมัดระวังเพื่อให้ได้ผลลัพธ์ที่ต้องการ

## ขั้นตอนที่ 1: ข้อกำหนดเบื้องต้น

ก่อนที่คุณจะเริ่มต้น ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้งไลบรารี Aspose.Cells สำหรับ .NET แล้ว คุณสามารถรับได้จากเว็บไซต์อย่างเป็นทางการของ Aspose ตรวจสอบให้แน่ใจว่าคุณมี Visual Studio เวอร์ชันล่าสุดหรือสภาพแวดล้อมการพัฒนา C# อื่น ๆ

## ขั้นตอนที่ 2: นำเข้าเนมสเปซที่จำเป็น

หากต้องการใช้ไลบรารี Aspose.Cells เราจำเป็นต้องนำเข้าเนมสเปซที่จำเป็นลงในโค้ดของเรา เพิ่มบรรทัดต่อไปนี้ที่ด้านบนของไฟล์ต้นฉบับ C# ของคุณ:

```csharp
using Aspose.Cells;
using System.IO;
```

## ขั้นตอนที่ 3: โหลดไฟล์ Excel

ในขั้นตอนนี้ เราจะโหลดไฟล์ Excel ที่เราต้องการป้องกัน อย่าลืมระบุเส้นทางที่ถูกต้องไปยังไดเร็กทอรีที่มีไฟล์ Excel ใช้รหัสต่อไปนี้เพื่ออัปโหลดไฟล์:

```csharp
// พาธไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR_DIRECTORY_OF_DOCUMENTS";

// สร้างสตรีมไฟล์ที่มีไฟล์ Excel เพื่อเปิด
FileStream fstream = new FileStream(dataDir + "book1.xls", FileMode.Open);

// สร้างอินสแตนซ์วัตถุสมุดงาน
//เปิดไฟล์ Excel ผ่านการสตรีมไฟล์
Workbook excel = new Workbook(fstream);
```

 อย่าลืมเปลี่ยน`"YOUR_DOCUMENTS_DIR"` ด้วยเส้นทางที่เหมาะสมไปยังไดเร็กทอรีเอกสารของคุณ

## ขั้นตอนที่ 4: เข้าถึงสเปรดชีต

ตอนนี้เราได้โหลดไฟล์ Excel แล้ว เราจึงสามารถเข้าถึงแผ่นงานแรกได้ ใช้รหัสต่อไปนี้เพื่อเข้าถึงแผ่นงานแรก:

```csharp
// เข้าถึงแผ่นงานแรกในไฟล์ Excel
Worksheet worksheet = excel.Worksheets[0];
```

## ขั้นตอนที่ 5: ป้องกันแผ่นงาน

ในขั้นตอนนี้ เราจะป้องกันสเปรดชีตโดยใช้รหัสผ่าน ใช้รหัสต่อไปนี้เพื่อป้องกันสเปรดชีต:

```csharp
// ป้องกันแผ่นงานด้วยรหัสผ่าน
worksheet.Protect(ProtectionType.All, "YOUR_PASSWORD", null);
```

 แทนที่`"YOUR_PASSWORD"` ด้วยรหัสผ่านที่คุณต้องการใช้เพื่อป้องกันสเปรดชีต

## ขั้นตอนที่ 6: บันทึกไฟล์ Excel ที่แก้ไขแล้ว ตอนนี้เราได้ป้องกันแล้ว

สำหรับสเปรดชีต เราจะบันทึกไฟล์ Excel ที่แก้ไขในรูปแบบเริ่มต้น ใช้รหัสต่อไปนี้เพื่อบันทึกไฟล์ Excel:

```csharp
// บันทึกไฟล์ Excel ที่แก้ไขในรูปแบบเริ่มต้น
excel.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```

ตรวจสอบให้แน่ใจว่าได้ระบุเส้นทางที่ถูกต้องเพื่อบันทึกไฟล์ Excel ที่แก้ไข

## ขั้นตอนที่ 7: ปิดสตรีมไฟล์

หากต้องการเผยแพร่ทรัพยากรทั้งหมด เราจำเป็นต้องปิดสตรีมไฟล์ที่ใช้ในการโหลดไฟล์ Excel ใช้รหัสต่อไปนี้เพื่อปิดสตรีมไฟล์:

```csharp
// ปิดสตรีมไฟล์เพื่อเผยแพร่ทรัพยากรทั้งหมด
fstream.Close();
```

อย่าลืมรวมขั้นตอนนี้ไว้ท้ายโค้ดของคุณ


### ตัวอย่างซอร์สโค้ดสำหรับแผ่นงาน Protect Excel โดยใช้ Aspose.Cells สำหรับ .NET 
```csharp
//เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";
// การสร้างสตรีมไฟล์ที่มีไฟล์ Excel ที่จะเปิด
FileStream fstream = new FileStream(dataDir + "book1.xls", FileMode.Open);
// การสร้างอินสแตนซ์วัตถุสมุดงาน
// การเปิดไฟล์ Excel ผ่านการสตรีมไฟล์
Workbook excel = new Workbook(fstream);
// การเข้าถึงแผ่นงานแรกในไฟล์ Excel
Worksheet worksheet = excel.Worksheets[0];
// การป้องกันแผ่นงานด้วยรหัสผ่าน
worksheet.Protect(ProtectionType.All, "aspose", null);
// บันทึกไฟล์ Excel ที่แก้ไขในรูปแบบเริ่มต้น
excel.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
// การปิดสตรีมไฟล์เพื่อเพิ่มทรัพยากรทั้งหมด
fstream.Close();
```

## บทสรุป

ขอแสดงความยินดี! ขณะนี้คุณมีซอร์สโค้ด C# ที่ช่วยให้คุณสามารถปกป้องสเปรดชีต Excel โดยใช้ไลบรารี Aspose.Cells สำหรับ .NET อย่าลืมทำตามขั้นตอนอย่างระมัดระวังและปรับแต่งโค้ดตามความต้องการเฉพาะของคุณ

### คำถามที่พบบ่อย (คำถามที่พบบ่อย)

#### เป็นไปได้หรือไม่ที่จะป้องกันแผ่นงานหลายแผ่นในไฟล์ Excel ไฟล์เดียว

ตอบ: ได้ คุณสามารถป้องกันแผ่นงานหลายแผ่นในไฟล์ Excel ไฟล์เดียวได้โดยทำซ้ำขั้นตอนที่ 4-6 สำหรับแต่ละแผ่นงาน

#### ฉันจะระบุสิทธิ์เฉพาะสำหรับผู้ใช้ที่ได้รับอนุญาตได้อย่างไร

 ตอบ: คุณสามารถใช้ตัวเลือกเพิ่มเติมที่ได้รับจาก`Protect`วิธีการระบุสิทธิ์เฉพาะสำหรับผู้ใช้ที่ได้รับอนุญาต ดูเอกสารประกอบของ Aspose.Cells สำหรับข้อมูลเพิ่มเติม

#### ฉันสามารถป้องกันไฟล์ Excel ด้วยรหัสผ่านได้หรือไม่

ตอบ: ได้ คุณสามารถใช้รหัสผ่านป้องกันไฟล์ Excel ได้โดยใช้วิธีการอื่นๆ ที่ไลบรารี Aspose.Cells มอบให้ โปรดดูเอกสารประกอบสำหรับตัวอย่างเฉพาะ

#### ไลบรารี Aspose.Cells รองรับไฟล์ Excel รูปแบบอื่นหรือไม่

ตอบ: ใช่ ไลบรารี Aspose.Cells รองรับรูปแบบไฟล์ Excel ที่หลากหลาย รวมถึง XLSX, XLSM, XLSB, CSV เป็นต้น