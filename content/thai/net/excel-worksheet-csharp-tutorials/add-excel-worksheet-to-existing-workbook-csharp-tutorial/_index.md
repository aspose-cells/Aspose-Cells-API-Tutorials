---
title: เพิ่มแผ่นงาน Excel ลงในสมุดงาน C# ที่มีอยู่
linktitle: เพิ่มแผ่นงาน Excel ลงในสมุดงานที่มีอยู่
second_title: Aspose.Cells สำหรับการอ้างอิง .NET API
description: เพิ่มแผ่นงานใหม่ลงในสมุดงาน Excel ที่มีอยู่ได้อย่างง่ายดายโดยใช้ Aspose.Cells for .NET บทช่วยสอนทีละขั้นตอนพร้อมตัวอย่างโค้ด
type: docs
weight: 10
url: /th/net/excel-worksheet-csharp-tutorials/add-excel-worksheet-to-existing-workbook-csharp-tutorial/
---
ในบทช่วยสอนนี้ เราจะอธิบายทีละขั้นตอนเพื่ออธิบายซอร์สโค้ด C# ด้านล่าง ซึ่งจะช่วยเพิ่มชีตใหม่ลงในสมุดงาน Excel ที่มีอยู่โดยใช้ Aspose.Cells for .NET เราจะรวมโค้ดตัวอย่างสำหรับแต่ละขั้นตอนเพื่อช่วยให้คุณเข้าใจกระบวนการโดยละเอียด

## ขั้นตอนที่ 1: กำหนดไดเร็กทอรีเอกสาร

ในการเริ่มต้น คุณต้องตั้งค่าเส้นทางไดเรกทอรีซึ่งมีไฟล์ Excel ของคุณอยู่ แทนที่ "ไดเรกทอรีเอกสารของคุณ" ในโค้ดด้วยเส้นทางจริงของไฟล์ Excel ของคุณ

```csharp
//เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## ขั้นตอนที่ 2: สร้างสตรีมไฟล์และเปิดไฟล์ Excel

 ถัดไป คุณต้องสร้างสตรีมไฟล์และเปิดไฟล์ Excel โดยใช้นามสกุลไฟล์`FileStream` ระดับ.

```csharp
// สร้างสตรีมไฟล์ที่มีไฟล์ Excel เพื่อเปิด
FileStream fstream = new FileStream(dataDir + "book1.xls", FileMode.Open);
```

## ขั้นตอนที่ 3: สร้างอินสแตนซ์ของวัตถุสมุดงาน

 หลังจากเปิดไฟล์ Excel แล้ว คุณจะต้องสร้างอินสแตนซ์ a`Workbook`วัตถุ. วัตถุนี้แสดงถึงสมุดงาน Excel และเสนอวิธีการและคุณสมบัติต่างๆ เพื่อจัดการสมุดงาน

```csharp
// สร้างอินสแตนซ์วัตถุสมุดงาน
// เปิดไฟล์ Excel ผ่านโฟลว์ไฟล์
Workbook workbook = new Workbook(fstream);
```

## ขั้นตอนที่ 4: เพิ่มแผ่นงานใหม่ลงในสมุดงาน

 หากต้องการเพิ่มแผ่นงานใหม่ลงในสมุดงาน คุณสามารถใช้`Worksheets.Add()` วิธีการของ`Workbook` วัตถุ. วิธีนี้จะส่งคืนดัชนีของแผ่นงานที่เพิ่มใหม่

```csharp
// เพิ่มแผ่นงานใหม่ลงในสมุดงานสมุดงาน
int i = workbook. Worksheets. Add();
```

## ขั้นตอนที่ 5: ตั้งชื่อชีตใหม่

 คุณสามารถตั้งชื่อแผ่นงานที่เพิ่มใหม่ได้โดยใช้`Name` ทรัพย์สินของ`Worksheet` วัตถุ.

```csharp
// รับการอ้างอิงของแผ่นงานใหม่ที่เพิ่มเข้ามาโดยส่งดัชนีแผ่นงาน
Worksheet worksheet = workbook.Worksheets[i];
// กำหนดชื่อของแผ่นงานใหม่
worksheet.Name = "My Worksheet";
```

## ขั้นตอนที่ 6: บันทึกไฟล์ Excel

 เมื่อคุณเพิ่มแผ่นงานใหม่และตั้งชื่อแล้ว คุณสามารถบันทึกไฟล์ Excel ที่แก้ไขได้โดยใช้นามสกุลไฟล์`Save()` วิธีการของ`Workbook` วัตถุ.

```csharp
// บันทึกไฟล์ Excel
workbook.Save(dataDir + "output.out.xls");
```

## ขั้นตอนที่ 7: ปิด File Stream และเผยแพร่ทรัพยากร

สุดท้ายนี้ สิ่งสำคัญคือต้องปิดสตรีมไฟล์เพื่อเผยแพร่ทรัพยากรทั้งหมดที่เกี่ยวข้อง

```csharp
// ปิดสตรีมไฟล์เพื่อเผยแพร่ทรัพยากรทั้งหมด
fstream.Close();
```

### ซอร์สโค้ดตัวอย่างสำหรับการเพิ่มแผ่นงาน Excel ไปยังสมุดงาน C# ที่มีอยู่โดยใช้ Aspose.Cells สำหรับ .NET 
```csharp
//เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";
// การสร้างสตรีมไฟล์ที่มีไฟล์ Excel ที่จะเปิด
FileStream fstream = new FileStream(dataDir + "book1.xls", FileMode.Open);
// การสร้างอินสแตนซ์วัตถุสมุดงาน
// การเปิดไฟล์ Excel ผ่านการสตรีมไฟล์
Workbook workbook = new Workbook(fstream);
// การเพิ่มแผ่นงานใหม่ให้กับวัตถุสมุดงาน
int i = workbook.Worksheets.Add();
// รับการอ้างอิงของเวิร์กชีทที่เพิ่มใหม่โดยส่งดัชนีชีต
Worksheet worksheet = workbook.Worksheets[i];
// การตั้งชื่อแผ่นงานที่เพิ่มเข้ามาใหม่
worksheet.Name = "My Worksheet";
// กำลังบันทึกไฟล์ Excel
workbook.Save(dataDir + "output.out.xls");
// การปิดสตรีมไฟล์เพื่อเพิ่มทรัพยากรทั้งหมด
fstream.Close();
```

## บทสรุป

ในบทช่วยสอนนี้ เราได้กล่าวถึงกระบวนการทีละขั้นตอนในการเพิ่ม fire Connect ใหม่ไปยังสมุดงาน Excel ที่มีอยู่โดยใช้ Aspose.Cells สำหรับ .NET เมื่อทำตามตัวอย่างโค้ดและคำอธิบายที่ให้ไว้ ตอนนี้คุณควรมีความเข้าใจเกี่ยวกับวิธีการทำงานนี้ในแอปพลิเคชัน C# ของคุณเป็นอย่างดี Aspose.Cells for .NET นำเสนอชุดคุณลักษณะที่ครอบคลุมสำหรับการทำงานกับไฟล์ Excel ซึ่งช่วยให้คุณสามารถทำงานต่างๆ ที่เกี่ยวข้องกับ Excel ได้อย่างมีประสิทธิภาพโดยอัตโนมัติ

### คำถามที่พบบ่อย (FAQ)

#### Aspose.Cells สำหรับ .NET คืออะไร

Aspose.Cells for .NET เป็นไลบรารี .NET อันทรงพลังที่ช่วยให้นักพัฒนาสามารถสร้าง จัดการ และแปลงไฟล์ Excel ในแอปพลิเคชันของตนได้ มีคุณสมบัติมากมายสำหรับการทำงานกับสเปรดชีต เซลล์ สูตร สไตล์ และอื่นๆ

#### ฉันจะติดตั้ง Aspose.Cells สำหรับ .NET ได้อย่างไร

หากต้องการติดตั้ง Aspose.Cells สำหรับ .NET คุณสามารถดาวน์โหลดแพ็คเกจการติดตั้งได้จาก Aspose Releases (https://releases.aspose.com/cells/net) และปฏิบัติตามคำแนะนำในการติดตั้งที่ให้ไว้ คุณจะต้องมีใบอนุญาตที่ถูกต้องเพื่อใช้ไลบรารีในแอปพลิเคชันของคุณ

#### ฉันสามารถเพิ่มสเปรดชีตหลายรายการโดยใช้ Aspose.Cells สำหรับ .NET ได้หรือไม่

 ได้ คุณสามารถเพิ่มเวิร์กชีทหลายแผ่นลงในไฟล์ Excel เดียวได้โดยใช้ Aspose.Cells for .NET คุณสามารถใช้`Worksheets.Add()` วิธีการของ`Workbook` วัตถุเพื่อเพิ่มแผ่นงานใหม่ในตำแหน่งที่แตกต่างกันในสมุดงาน

#### ฉันจะจัดรูปแบบเซลล์ในไฟล์ Excel ได้อย่างไร

Aspose.Cells สำหรับ .NET นำเสนอวิธีการและคุณสมบัติที่แตกต่างกันในการจัดรูปแบบเซลล์ในไฟล์ Excel คุณสามารถตั้งค่าเซลล์ ใช้ตัวเลือกการจัดรูปแบบ เช่น ลักษณะแบบอักษร สี การจัดแนว เส้นขอบ และอื่นๆ ได้ ดูเอกสารประกอบและโค้ดตัวอย่างที่ Aspose.Cells มอบให้สำหรับข้อมูลโดยละเอียดเพิ่มเติมเกี่ยวกับการจัดรูปแบบเซลล์

#### Aspose.Cells สำหรับ .NET เข้ากันได้กับ Excel เวอร์ชันต่างๆ หรือไม่

ใช่ Aspose.Cells สำหรับ .NET เข้ากันได้กับ Excel เวอร์ชันต่างๆ รวมถึง Excel 2003, Excel 2007, Excel 2010, Excel 2013, Excel 2016, Excel 2019 และ Excel for Office 365 โดยรองรับทั้งรูปแบบ .xls และรูปแบบที่ใหม่กว่า รูปแบบ xlsx