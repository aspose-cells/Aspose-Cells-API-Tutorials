---
title: การสร้างการตรวจสอบข้อมูลที่กำหนดเอง
linktitle: การสร้างการตรวจสอบข้อมูลที่กำหนดเอง
second_title: Aspose.Cells Java Excel การประมวลผล API
description: เรียนรู้วิธีสร้างการตรวจสอบข้อมูลแบบกำหนดเองโดยใช้ Aspose.Cells สำหรับ Java คำแนะนำทีละขั้นตอนพร้อมซอร์สโค้ด
type: docs
weight: 10
url: /th/java/data-validation-rules/creating-custom-data-validation/
---

## การแนะนำ

การตรวจสอบความถูกต้องของข้อมูลช่วยรักษาความสมบูรณ์ของข้อมูลโดยการป้องกันไม่ให้ผู้ใช้ป้อนข้อมูลที่ไม่ถูกต้องหรือไม่ถูกต้องลงในสเปรดชีต Excel แม้ว่า Excel จะมีตัวเลือกการตรวจสอบความถูกต้องของข้อมูลในตัว แต่ก็มีสถานการณ์ที่คุณจำเป็นต้องกำหนดกฎการตรวจสอบแบบกำหนดเอง Aspose.Cells สำหรับ Java ช่วยให้คุณบรรลุเป้าหมายนี้ได้อย่างมีประสิทธิภาพ

## ข้อกำหนดเบื้องต้น

ก่อนที่จะเจาะลึกโค้ด ตรวจสอบให้แน่ใจว่าคุณมีข้อกำหนดเบื้องต้นต่อไปนี้:

-  Aspose.Cells สำหรับ Java: ดาวน์โหลดและติดตั้งไลบรารีจาก[ที่นี่](https://releases.aspose.com/cells/java/).

## ขั้นตอนที่ 1: การตั้งค่าโครงการ Java ของคุณ

ในการเริ่มต้น ให้สร้างโปรเจ็กต์ Java ใหม่ใน Integrated Development Environment (IDE) ที่คุณต้องการ เพิ่มไลบรารี Aspose.Cells for Java ให้กับ classpath ของโปรเจ็กต์ของคุณ

## ขั้นตอนที่ 2: การสร้างสมุดงาน Excel

เริ่มต้นด้วยการสร้างสมุดงาน Excel ใหม่โดยใช้ Aspose.Cells for Java

```java
// รหัส Java เพื่อสร้างสมุดงาน Excel ใหม่
Workbook workbook = new Workbook();
```

## ขั้นตอนที่ 3: การเพิ่มแผ่นงาน

ตอนนี้ เรามาเพิ่มแผ่นงานลงในสมุดงานที่เราจะใช้การตรวจสอบข้อมูลที่กำหนดเองของเรา

```java
// รหัส Java เพื่อเพิ่มแผ่นงาน
Worksheet worksheet = workbook.getWorksheets().get(0);
```

## ขั้นตอนที่ 4: การกำหนดเกณฑ์การตรวจสอบแบบกำหนดเอง

ในขั้นตอนนี้ เราจะกำหนดเกณฑ์การตรวจสอบที่กำหนดเองซึ่งข้อมูลของเราต้องปฏิบัติตาม สมมติว่าเราต้องการจำกัดอายุที่ป้อนในเซลล์ให้อยู่ระหว่าง 18 ถึง 60

```java
// รหัส Java เพื่อกำหนดเกณฑ์การตรวจสอบแบบกำหนดเอง
Validation validation = worksheet.getValidations().add();
validation.setType(ValidationType.WHOLE);
validation.setOperator(OperatorType.BETWEEN);
validation.setFormula1("18");
validation.setFormula2("60");
validation.setShowError(true);
validation.setAlertStyle(ValidationAlertType.STOP);
validation.setErrorTitle("Invalid Age");
validation.setErrorMessage("Age must be between 18 and 60.");
```

## ขั้นตอนที่ 5: การใช้การตรวจสอบความถูกต้องของข้อมูลกับช่วง

ตอนนี้เราได้กำหนดเกณฑ์การตรวจสอบแบบกำหนดเองแล้ว เรามานำไปใช้กับช่วงของเซลล์ที่ต้องการกันดีกว่า

```java
// รหัส Java เพื่อใช้การตรวจสอบข้อมูลกับช่วง
CellArea area = new CellArea();
area.startRow = 0;
area.startColumn = 0;
area.endRow = 9; // ใช้การตรวจสอบความถูกต้องกับสิบแถวแรก
area.endColumn = 0;

validation.addArea(area);
```

## ขั้นตอนที่ 6: บันทึกไฟล์ Excel

สุดท้าย ให้บันทึกไฟล์ Excel โดยใช้กฎการตรวจสอบความถูกต้องของข้อมูลแบบกำหนดเอง

```java
// รหัส Java เพื่อบันทึกไฟล์ Excel
workbook.save("CustomDataValidation.xlsx");
```

## บทสรุป

ในบทช่วยสอนนี้ เราได้สำรวจวิธีสร้างกฎการตรวจสอบข้อมูลแบบกำหนดเองโดยใช้ Aspose.Cells สำหรับ Java ด้วยการทำตามขั้นตอนเหล่านี้ คุณสามารถมั่นใจได้ว่าข้อมูล Excel ของคุณเป็นไปตามเกณฑ์เฉพาะ ซึ่งช่วยเพิ่มความสมบูรณ์และความถูกต้องของข้อมูล

## คำถามที่พบบ่อย

### ฉันจะดาวน์โหลด Aspose.Cells สำหรับ Java ได้อย่างไร

 คุณสามารถดาวน์โหลด Aspose.Cells สำหรับ Java ได้จากเว็บไซต์ที่[ที่นี่](https://releases.aspose.com/cells/java/).

### ฉันสามารถใช้การตรวจสอบข้อมูลแบบกำหนดเองกับหลายช่วงในเวิร์กชีตเดียวกันได้หรือไม่

ได้ คุณสามารถใช้การตรวจสอบข้อมูลแบบกำหนดเองกับหลายช่วงภายในเวิร์กชีตเดียวกันได้ โดยทำซ้ำขั้นตอนที่ 5 สำหรับแต่ละช่วงที่ต้องการ

### Aspose.Cells สำหรับ Java รองรับการตรวจสอบข้อมูลประเภทอื่นหรือไม่

ใช่ Aspose.Cells สำหรับ Java รองรับการตรวจสอบข้อมูลหลายประเภท รวมถึงจำนวนเต็ม ทศนิยม วันที่ เวลา ความยาวข้อความ และอื่นๆ

### ฉันจะปรับแต่งข้อความแสดงข้อผิดพลาดที่แสดงเมื่อการตรวจสอบข้อมูลล้มเหลวได้อย่างไร

 คุณสามารถปรับแต่งข้อความแสดงข้อผิดพลาดได้โดยการแก้ไข`setErrorMessage` วิธีการในขั้นตอนที่ 4 ซึ่งคุณกำหนดเกณฑ์การตรวจสอบ

### Aspose.Cells สำหรับ Java ทำงานกับไฟล์ Excel ในรูปแบบที่แตกต่างกันหรือไม่

ใช่ Aspose.Cells สำหรับ Java รองรับรูปแบบไฟล์ Excel ที่หลากหลาย รวมถึง XLS, XLSX, XLSM และอื่นๆ