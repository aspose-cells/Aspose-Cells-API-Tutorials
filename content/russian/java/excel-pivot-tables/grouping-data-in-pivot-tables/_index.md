---
title: Группировка данных в сводных таблицах
linktitle: Группировка данных в сводных таблицах
second_title: Aspose.Cells API обработки Java Excel
description: Узнайте, как создавать сводные таблицы в Excel с помощью Aspose.Cells для Java. Автоматизируйте группировку и анализ данных с помощью примеров исходного кода.
type: docs
weight: 14
url: /ru/java/excel-pivot-tables/grouping-data-in-pivot-tables/
---

Сводные таблицы — мощный инструмент для анализа и обобщения данных в электронных таблицах. Они позволяют группировать и классифицировать данные для получения ценной информации. В этой статье мы рассмотрим, как эффективно группировать данные в сводных таблицах с помощью Aspose.Cells для Java, а также приведем примеры исходного кода.

## Введение

Сводные таблицы предоставляют гибкий способ организации и обобщения данных из больших наборов данных. Они позволяют вам создавать собственные представления ваших данных, группируя их по категориям или иерархиям. Это поможет вам легче выявлять тенденции, закономерности и выбросы в ваших данных.

## Шаг 1. Создайте сводную таблицу

Начнем с создания сводной таблицы с помощью Aspose.Cells для Java. Ниже приведен пример создания сводной таблицы из образца файла Excel.

```java
// Загрузите файл Excel
Workbook workbook = new Workbook("sample.xlsx");

// Доступ к листу, содержащему данные
Worksheet worksheet = workbook.getWorksheets().get(0);

// Укажите диапазон данных
CellArea sourceData = new CellArea();
sourceData.startRow = 0;
sourceData.endRow = 19; // Предполагая 20 строк данных
sourceData.startColumn = 0;
sourceData.endColumn = 3; // Предполагая 4 столбца данных

// Создайте сводную таблицу на основе диапазона данных.
int index = worksheet.getPivotTables().add(sourceData, "A1", "PivotTable1");

// Получить сводную таблицу по индексу
PivotTable pivotTable = worksheet.getPivotTables().get(index);

// Добавляйте поля в строки и столбцы
pivotTable.addFieldToArea("Product", PivotFieldType.ROW);
pivotTable.addFieldToArea("Region", PivotFieldType.COLUMN);

// Добавьте значения и примените агрегирование
pivotTable.addFieldToArea("Sales", PivotFieldType.DATA);
pivotTable.getDataFields().get(0).setFunction(PivotFieldFunction.SUM);

// Сохраните измененный файл Excel.
workbook.save("output.xlsx");
```

## Шаг 2: Групповые данные

 В Aspose.Cells для Java вы можете группировать данные в сводной таблице, используя`PivotField` сорт. Вот пример того, как сгруппировать поле в сводной таблице:

```java
// Доступ к полю «Продукт» в сводной таблице.
PivotField productField = pivotTable.getPivotFields().get("Product");

//Группируйте поле «Товар» по определенному критерию, например, по начальной букве.
productField.setIsAutoSubtotals(false);
productField.setBaseField("Product");
productField.setAutoSort(true);
productField.setAutoShow(true);

// Сохраните измененный файл Excel с сгруппированными данными.
workbook.save("output_grouped.xlsx");
```

## Шаг 3. Настройте группировку

Вы можете дополнительно настроить параметры группировки, например указать интервалы группировки на основе даты или настраиваемые правила группировки. Вот пример настройки группировки по дате:

```java
// Получите доступ к полю «Дата» в сводной таблице (при условии, что это поле даты).
PivotField dateField = pivotTable.getPivotFields().get("Date");

// Группировать даты по месяцам
dateField.setIsAutoSubtotals(false);
dateField.setIsDateGroup(true);
dateField.setDateGroupingType(PivotFieldDateGroupingType.MONTHS);

// Сохраните измененный файл Excel с произвольной группировкой дат.
workbook.save("output_custom_grouping.xlsx");
```

## Заключение

Группировка данных в сводных таблицах — ценный метод анализа и обобщения данных в Excel, а Aspose.Cells для Java позволяет легко автоматизировать этот процесс. С помощью предоставленных примеров исходного кода вы можете создавать сводные таблицы, настраивать группировку и эффективно получать аналитическую информацию из своих данных.

## Часто задаваемые вопросы

### 1. Каково назначение сводных таблиц в Excel?

Сводные таблицы в Excel используются для обобщения и анализа больших наборов данных. Они позволяют вам создавать собственные представления ваших данных, что упрощает выявление закономерностей и тенденций.

### 2. Как настроить группировку данных в сводной таблице?

 Вы можете настроить группировку данных в сводной таблице с помощью кнопки`PivotField` класс в Aspose.Cells для Java. Это позволяет вам указать критерии группировки, такие как интервалы на основе дат или пользовательские правила.

### 3. Могу ли я автоматизировать создание сводных таблиц с помощью Aspose.Cells для Java?

Да, вы можете автоматизировать создание сводных таблиц в Excel с помощью Aspose.Cells для Java, как показано в предоставленных примерах исходного кода.