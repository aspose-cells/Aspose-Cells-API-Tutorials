---
title: Добавление нового листа в учебник Excel по C#
linktitle: Добавить новый лист в Excel
second_title: Справочник по API Aspose.Cells для .NET
description: Узнайте, как добавить новый лист в Excel с помощью Aspose.Cells для .NET. Пошаговое руководство с исходным кодом на C#.
type: docs
weight: 20
url: /ru/net/excel-worksheet-csharp-tutorials/add-new-sheet-in-excel-csharp-tutorial/
---
В этом уроке мы шаг за шагом объясним исходный код C# для добавления нового листа в Excel с помощью Aspose.Cells для .NET. Добавление нового листа в книгу Excel — обычная операция при создании отчетов или манипулировании данными. Aspose.Cells — это мощная библиотека, которая позволяет легко манипулировать и создавать файлы Excel с использованием .NET. Выполните следующие шаги, чтобы понять и реализовать этот код.

## Шаг 1. Настройка каталога документов

Первый шаг — определить каталог документа, в котором будет сохранен файл Excel. Если каталог не существует, мы создаем его, используя следующий код:

```csharp
//Путь к каталогу документов.
string dataDir = "YOUR DOCUMENTS DIRECTORY";
// Создайте каталог, если он еще не существует.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
System.IO.Directory.CreateDirectory(dataDir);
```

Обязательно замените «КАТАЛОГ ВАШИХ ДОКУМЕНТОВ» на соответствующий путь к каталогу ваших документов.

## Шаг 2. Создание экземпляра объекта книги

Второй шаг — создать экземпляр объекта Workbook, который представляет книгу Excel. Используйте следующий код:

```csharp
Workbook workbook = new Workbook();
```

Этот объект будет использоваться для добавления нового листа и выполнения других операций с книгой Excel.

## Шаг 3. Добавление нового листа

Третий шаг — добавить новый лист к объекту Workbook. Используйте следующий код:

```csharp
int index = workbook. Worksheets. Add();
Worksheet worksheet = workbook.Worksheets[index];
```

Это добавит новый лист к объекту Workbook, и вы получите ссылку на этот лист, используя его индекс.

## Шаг 4. Установка имени нового листа

Четвертый шаг — дать новому листу имя. Вы можете использовать следующий код, чтобы установить имя листа:

```csharp
worksheet.Name = "My Worksheet";
```

Замените «Моя таблица» на желаемое имя нового листа.

## Шаг 5. Сохранение файла Excel

Наконец, последний шаг — сохранить файл Excel. Используйте следующий код:

```csharp
string filePath = dataDir + "output.out.xls";
workbook.Save(filePath);
```

Книга Excel с новым листом будет сохранена в указанном вами каталоге документов.

### Пример исходного кода для учебника «Добавление нового листа в Excel C#» с использованием Aspose.Cells для .NET 
```csharp
//Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// Создайте каталог, если он еще не существует.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
	System.IO.Directory.CreateDirectory(dataDir);
// Создание экземпляра объекта Workbook
Workbook workbook = new Workbook();
// Добавление нового листа в объект Workbook
int i = workbook.Worksheets.Add();
// Получение ссылки на вновь добавленный лист путем передачи его индекса листа
Worksheet worksheet = workbook.Worksheets[i];
// Установка имени вновь добавленного листа
worksheet.Name = "My Worksheet";
// Сохранение файла Excel
workbook.Save(dataDir + "output.out.xls");
```

## Заключение

Теперь вы узнали, как добавить новый лист в Excel с помощью Aspose.Cells для .NET. Этот метод можно использовать для управления и создания файлов Excel с помощью C#. Aspose.Cells предлагает множество мощных функций, упрощающих обработку файлов Excel в ваших приложениях.

### Часто задаваемые вопросы (FAQ)

#### Могу ли я использовать Aspose.Cells с другими языками программирования, кроме C#?

Да, Aspose.Cells поддерживает несколько языков программирования, таких как Java, Python, Ruby и многие другие.

#### Могу ли я добавить форматирование к ячейкам на вновь созданном листе?

Да, вы можете применить форматирование к ячейкам, используя методы, предоставляемые классом Worksheet Aspose.Cells. Вы можете установить стиль ячейки, изменить цвет фона, применить границы и т. д.

#### Как я могу получить доступ к данным ячеек из нового листа?

Вы можете получить доступ к данным ячеек, используя свойства и методы, предоставляемые классом Worksheet Aspose.Cells. Например, вы можете использовать свойство Cells для доступа к определенной ячейке и получения или изменения ее значения.

#### Поддерживает ли Aspose.Cells формулы в Excel?

Да, Aspose.Cells поддерживает формулы Excel. Вы можете задать формулы в ячейках листа, используя метод SetFormula класса Cell.
