---
title: Excel скопировать лист из другой книги
linktitle: Excel скопировать лист из другой книги
second_title: Справочник по API Aspose.Cells для .NET
description: Легко скопируйте лист Excel из одной книги в другую с помощью Aspose.Cells для .NET.
type: docs
weight: 10
url: /ru/net/excel-copy-worksheet/excel-copy-worksheet-from-other-workbook/
---
В этом уроке мы покажем вам, как скопировать лист Excel из другой книги с помощью библиотеки Aspose.Cells для .NET. Следуйте инструкциям ниже, чтобы выполнить эту задачу.

## Шаг 1: Подготовка

Прежде чем начать, убедитесь, что вы установили Aspose.Cells для .NET и создали проект C# в предпочитаемой вами интегрированной среде разработки (IDE).

## Шаг 2. Установите путь к каталогу документов.

 Объявить`dataDir` переменную и инициализируйте ее путем к каталогу ваших документов. Например :

```csharp
string dataDir = "YOUR_DIRECTORY_OF_DOCUMENTS";
```

 Обязательно замените`"YOUR_DOCUMENTS_DIRECTORY"` с фактическим путем к вашему каталогу.

## Шаг 3. Создайте новую книгу Excel.

 Использовать`Workbook` класс из Aspose.Cells для создания новой книги Excel:

```csharp
Workbook excelWorkbook0 = new Workbook();
```

## Шаг 4. Получите первый лист в книге.

Перейдите к первому листу книги, используя индекс 0:

```csharp
Worksheet ws0 = excelWorkbook0.Worksheets[0];
```

## Шаг 5. Добавьте данные в строки заголовков (A1:A4).

 Использовать`for` цикл для добавления данных в строки заголовка (A1:A4):

```csharp
for (int i = 0; i < 5; i++)
{
     ws0.Cells[i, 0].PutValue(string.Format("Header row {0}", i));
}
```

## Шаг 6. Добавьте подробные данные (A5:A999).

 Используйте другой`for` цикл для добавления подробных данных (A5:A999):

```csharp
for (int i = 5; i < 1000; i++)
{
     ws0.Cells[i, 0].PutValue(string.Format("Detail row {0}", i));
}
```

## Шаг 7. Установите параметры макета

 Установите параметры настройки страницы для рабочего листа с помощью`PageSetup` объект:

```csharp
PageSetup pagesetup = ws0.PageSetup;
pagesetup.PrintTitleRows = "$1:$5";
```

## Шаг 8. Создайте еще одну книгу Excel.

Создайте еще одну книгу Excel:

```csharp
Workbook excelWorkbook1 = new Workbook();
```

## Шаг 9. Получите первый лист из второй книги.

Перейдите к первому листу во второй книге:

```csharp
Worksheet ws1 = excelWorkbook1.Worksheets[0];
```

## Шаг 10: Назовите лист

назови огонь

расчетный остров:

```csharp
ws1.Name = "MySheet";
```

## Шаг 11. Скопируйте данные с первого листа первой книги на первый лист второй книги.

Скопируйте данные с первого листа первой книги на первый лист второй книги:

```csharp
ws1.Copy(ws0);
```

## Шаг 12. Сохраните файл Excel.

Сохраните файл Excel:

```csharp
excelWorkbook1.Save(dataDir + "CopyWorkbookSheetToOther_out.xls");
```

Обязательно укажите желаемый путь и имя выходного файла.

### Пример исходного кода для копирования листа Excel из другой книги с помощью Aspose.Cells для .NET 
```csharp
//Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// Создайте новую книгу.
Workbook excelWorkbook0 = new Workbook();
// Возьмите первый рабочий лист в книге.
Worksheet ws0 = excelWorkbook0.Worksheets[0];
// Поместите некоторые данные в строки заголовка (A1:A4).
for (int i = 0; i < 5; i++)
{
	ws0.Cells[i, 0].PutValue(string.Format("Header Row {0}", i));
}
// Поместите некоторые подробные данные (A5:A999).
for (int i = 5; i < 1000; i++)
{
	ws0.Cells[i, 0].PutValue(string.Format("Detail Row {0}", i));
}
// Определите объект настройки страницы на основе первого листа.
PageSetup pagesetup = ws0.PageSetup;
// Первые пять строк повторяются на каждой странице...
// Его можно увидеть в предварительном просмотре печати.
pagesetup.PrintTitleRows = "$1:$5";
// Создайте еще одну книгу.
Workbook excelWorkbook1 = new Workbook();
// Возьмите первый рабочий лист в книге.
Worksheet ws1 = excelWorkbook1.Worksheets[0];
// Назовите рабочий лист.
ws1.Name = "MySheet";
// Скопируйте данные из первого листа первой книги в
// первый лист второй книги.
ws1.Copy(ws0);
// Сохраните файл Excel.
excelWorkbook1.Save(dataDir + "CopyWorksheetFromWorkbookToOther_out.xls");
```

## Заключение

Поздравляем! Теперь вы узнали, как скопировать лист Excel из другой книги с помощью Aspose.Cells для .NET. Не стесняйтесь использовать этот метод в своих проектах для эффективного управления файлами Excel.

### Часто задаваемые вопросы

#### Вопрос. Какие библиотеки необходимы для использования Aspose.Cells для .NET?

A. Чтобы использовать Aspose.Cells для .NET, вы должны включить библиотеку Aspose.Cells в свой проект. Убедитесь, что вы правильно указали эту библиотеку в своей интегрированной среде разработки (IDE).

#### Вопрос. Поддерживает ли Aspose.Cells другие форматы файлов Excel, например XLSX?

A. Да, Aspose.Cells поддерживает различные форматы файлов Excel, включая XLSX, XLS, CSV, HTML и многие другие. Вы можете манипулировать этими форматами файлов, используя функции Aspose.Cells для .NET.

#### Вопрос. Могу ли я настроить параметры макета при копировании листа?

A.  Да, вы можете настроить параметры настройки страницы при копировании листа, используя свойства`PageSetup` объект. Вы можете указать верхние и нижние колонтитулы страниц, поля, ориентацию и т. д.