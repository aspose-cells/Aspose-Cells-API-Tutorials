---
title: Разблокировать защищенный лист Excel
linktitle: Разблокировать защищенный лист Excel
second_title: Справочник по Aspose.Cells для .NET API
description: Узнайте, как разблокировать защищенную электронную таблицу Excel с помощью Aspose.Cells для .NET. Пошаговое руководство по C#.
type: docs
weight: 20
url: /ru/net/unprotect-excel-sheet/unlock-protected-excel-sheet/
---
Защита электронной таблицы Excel часто используется для ограничения доступа к данным и их изменения. В этом руководстве мы шаг за шагом проведем вас, чтобы понять и внедрить предоставленный исходный код C#, чтобы разблокировать защищенную электронную таблицу Excel с помощью библиотеки Aspose.Cells для .NET.

## Шаг 1: Подготовка среды

Прежде чем начать, убедитесь, что на вашем компьютере установлен Aspose.Cells for .NET. Вы можете скачать библиотеку с официального сайта Aspose и установить ее, следуя предоставленным инструкциям.

После завершения установки создайте новый проект C# в предпочитаемой интегрированной среде разработки (IDE) и импортируйте библиотеку Aspose.Cells для .NET.

## Шаг 2. Настройка пути к каталогу документов

 В предоставленном исходном коде вам необходимо указать путь к каталогу, в котором находится файл Excel, который вы хотите разблокировать. Изменить`dataDir` переменную, заменив "YOUR DOCUMENT DIRECTORY" абсолютным путем к каталогу на вашем компьютере.

```csharp
// Путь к каталогу документов.
string dataDir = "PATH TO YOUR DOCUMENTS DIRECTORY";
```

## Шаг 3: Создание объекта рабочей книги

Для начала нам нужно создать объект Workbook, представляющий наш файл Excel. Используйте конструктор класса Workbook и укажите полный путь к открываемому файлу Excel.

```csharp
// Создание экземпляра объекта Workbook
Workbook workbook = new Workbook(dataDir + "book1.xls");
```

## Шаг 4: Доступ к электронной таблице

 Далее нам нужно перейти к первому рабочему листу в файле Excel. Использовать`Worksheets` объекта Workbook для доступа к коллекции рабочих листов, а затем используйте свойство`[0]` index для доступа к первому листу.

```csharp
// Доступ к первому рабочему листу в файле Excel
Worksheet worksheet = workbook.Worksheets[0];
```

## Шаг 5: Разблокировка электронной таблицы

 Теперь мы разблокируем рабочий лист с помощью`Unprotect()` метод объекта Worksheet. Оставьте строку пароля пустой (`""`), если электронная таблица не защищена паролем.

```csharp
// Снятие защиты листа паролем
worksheet.Unprotect("");
```

## Шаг 6: Сохранение разблокированного файла Excel

Как только электронная таблица разблокирована, мы можем сохранить окончательный файл Excel. Использовать`Save()` метод, чтобы указать полный путь к выходному файлу.

```csharp
// Сохранить книгу


workbook.Save(dataDir + "output.out.xls");
```

### Пример исходного кода для разблокировки защищенного листа Excel с помощью Aspose.Cells для .NET 
```csharp
try
{
    // Путь к каталогу документов.
    string dataDir = "YOUR DOCUMENT DIRECTORY";
    // Создание экземпляра объекта Workbook
    Workbook workbook = new Workbook(dataDir + "book1.xls");
    // Доступ к первому рабочему листу в файле Excel
    Worksheet worksheet = workbook.Worksheets[0];
    // Снятие защиты листа паролем
    worksheet.Unprotect("");
    // Сохранить книгу
    workbook.Save(dataDir + "output.out.xls");
}
catch(Exception ex)
{
    Console.WriteLine(ex.Message);
    Console.ReadLine();
}
```

## Заключение

Поздравляем! Теперь вы выяснили, как использовать Aspose.Cells для .NET, чтобы разблокировать защищенную электронную таблицу Excel с помощью исходного кода C#. Выполняя шаги, описанные в этом руководстве, вы сможете применить эту функцию к своим собственным проектам и эффективно и безопасно работать с файлами Excel.

Не стесняйтесь дополнительно изучать функции, предлагаемые Aspose.Cells для более продвинутых операций.

### Часто задаваемые вопросы

#### В: Какие меры предосторожности следует предпринять при разблокировке защищенной электронной таблицы Excel?

О: При разблокировке защищенной электронной таблицы Excel убедитесь, что у вас есть необходимые разрешения для доступа к файлу. Кроме того, убедитесь, что вы используете правильный метод разблокировки, и укажите правильный пароль, если применимо.

#### В: Как узнать, защищена ли таблица паролем?

 О: Вы можете проверить, защищен ли рабочий лист паролем, используя свойства или методы из библиотеки Aspose.Cells для .NET. Например, вы можете использовать`IsProtected()` метод объекта Worksheet для проверки состояния защиты листа.

#### В: Я получаю исключение при попытке разблокировать электронную таблицу. Что я должен делать ?

О: Если вы столкнулись с исключением при разблокировке электронной таблицы, убедитесь, что вы правильно указали путь к файлу Excel, и убедитесь, что у вас есть необходимые разрешения для доступа к файлу. Если проблема не устранена, не стесняйтесь обращаться в службу поддержки Aspose.Cells для получения дополнительной помощи.