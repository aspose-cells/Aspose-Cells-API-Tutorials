---
title: Установить верхние и нижние колонтитулы Excel
linktitle: Установить верхние и нижние колонтитулы Excel
second_title: Справочник по Aspose.Cells для .NET API
description: Узнайте, как установить верхние и нижние колонтитулы в Excel с помощью Aspose.Cells для .NET.
type: docs
weight: 100
url: /ru/net/excel-page-setup/set-excel-headers-and-footers/
---

В этом уроке мы покажем вам шаг за шагом, как установить верхние и нижние колонтитулы в Excel с помощью Aspose.Cells для .NET. Мы будем использовать исходный код C#, чтобы проиллюстрировать процесс.

## Шаг 1. Настройка среды

Убедитесь, что на вашем компьютере установлен Aspose.Cells for .NET. Также создайте новый проект в предпочитаемой вами среде разработки.

## Шаг 2: Импортируйте необходимые библиотеки

В файл кода импортируйте библиотеки, необходимые для работы с Aspose.Cells. Вот соответствующий код:

```csharp
using Aspose.Cells;
```

## Шаг 3: Установите каталог данных

Установите каталог данных, в котором вы хотите сохранить измененный файл Excel. Используйте следующий код:

```csharp
string dataDir = "YOUR DATA DIRECTORY";
```

Обязательно укажите полный путь к каталогу.

## Шаг 4: Создание книги и листа

Создайте новый объект Workbook и перейдите к первому рабочему листу в рабочей книге, используя следующий код:

```csharp
Workbook excel = new Workbook();
PageSetup pageSetup = excel.Worksheets[0].PageSetup;
```

Это создаст пустую рабочую книгу с рабочим листом и предоставит доступ к объекту PageSetup этого рабочего листа.

## Шаг 5: Настройка заголовков

 Установите заголовки электронной таблицы с помощью`SetHeader` методы объекта PageSetup. Вот пример кода:

```csharp
pageSetup.SetHeader(0, "&A");
pageSetup.SetHeader(1, "&\"Times New Roman,Bold\"&D-&T");
pageSetup.SetHeader(2, "&\"Times New Roman,Bold\"&12&F");
```

Это установит имя рабочего листа, текущую дату и время, а также имя файла в заголовках соответственно.

## Шаг 6: Определение нижних колонтитулов

 Установите нижние колонтитулы электронной таблицы, используя`SetFooter` методы объекта PageSetup. Вот пример кода:

```csharp
pageSetup.SetFooter(0, "Hello World! &\"Courier New\"&14 123");
pageSetup.SetFooter(1, "&P");
pageSetup.SetFooter(2, "&N");
```

Это соответственно установит текстовую строку, текущий номер страницы и общее количество страниц в нижних колонтитулах.

## Шаг 7: Сохранение измененной книги

Сохраните измененную книгу, используя следующий код:

```csharp
excel.Save(dataDir + "OutputFileName.xls");
```

Это сохранит измененную книгу в указанном каталоге данных.

### Пример исходного кода для установки верхних и нижних колонтитулов Excel с использованием Aspose.Cells для .NET 
```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// Создание экземпляра объекта Workbook
Workbook excel = new Workbook();
// Получение ссылки на PageSetup рабочего листа
PageSetup pageSetup = excel.Worksheets[0].PageSetup;
// Установка имени рабочего листа в левой части заголовка
pageSetup.SetHeader(0, "&A");
//Установка текущей даты и текущего времени в центральной части заголовка
// и изменить шрифт заголовка
pageSetup.SetHeader(1, "&\"Times New Roman,Bold\"&D-&T");
// Установка текущего имени файла в правой части заголовка и изменение
// шрифт заголовка
pageSetup.SetHeader(2, "&\"Times New Roman,Bold\"&12&F");
// Установка строки в левой части нижнего колонтитула и изменение шрифта
// часть этой строки ("123")
pageSetup.SetFooter(0, "Hello World! &\"Courier New\"&14 123");
// Установка номера текущей страницы в центральной части нижнего колонтитула
pageSetup.SetFooter(1, "&P");
// Установка количества страниц в правой части нижнего колонтитула
pageSetup.SetFooter(2, "&N");
// Сохраните рабочую книгу.
excel.Save(dataDir + "SetHeadersAndFooters_out.xls");
```


## Заключение

Теперь вы узнали, как устанавливать верхние и нижние колонтитулы в Excel с помощью Aspose.Cells для .NET. В этом учебном пособии вы прошли все этапы процесса, от настройки среды до сохранения измененной книги. Не стесняйтесь дополнительно изучать возможности Aspose.Cells для выполнения дальнейших манипуляций с вашими файлами Excel.

### Часто задаваемые вопросы (FAQ)

#### 1. Как я могу установить Aspose.Cells для .NET в своей системе?
Чтобы установить Aspose.Cells для .NET, вам необходимо скачать установочный пакет с официального сайта Aspose и следовать инструкциям, приведенным в документации.

#### 2. Этот метод работает со всеми версиями Excel?
Да, метод настройки верхних и нижних колонтитулов с помощью Aspose.Cells для .NET работает со всеми поддерживаемыми версиями Excel.

#### 3. Могу ли я дополнительно настроить верхние и нижние колонтитулы?
Да, Aspose.Cells предлагает широкий спектр функций для настройки верхних и нижних колонтитулов, включая размещение текста, цвет, шрифт, номера страниц и многое другое.

#### 4. Как добавить динамическую информацию в верхние и нижние колонтитулы?
Вы можете использовать специальные переменные и коды форматирования для добавления динамической информации, такой как текущая дата, время, имя файла, номер страницы и т. д., в верхние и нижние колонтитулы.

#### 5. Могу ли я удалить верхние и нижние колонтитулы после их установки?
 Да, вы можете удалить верхние и нижние колонтитулы, используя`ClearHeaderFooter` метод`PageSetup` объект. Это восстановит верхние и нижние колонтитулы по умолчанию.