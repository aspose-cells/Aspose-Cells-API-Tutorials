---
title: Вставить изображение в верхний колонтитул
linktitle: Вставить изображение в верхний колонтитул
second_title: Справочник по API Aspose.Cells для .NET
description: Узнайте, как вставить изображение в верхний или нижний колонтитул документа Excel с помощью Aspose.Cells для .NET. Пошаговое руководство с исходным кодом на C#.
type: docs
weight: 60
url: /ru/net/excel-page-setup/insert-image-in-header-footer/
---
Возможность вставлять изображение в верхний или нижний колонтитул документа Excel может быть очень полезна для настройки отчетов или добавления логотипов компании. В этой статье мы шаг за шагом покажем вам, как вставить изображение в верхний или нижний колонтитул документа Excel с помощью Aspose.Cells для .NET. Вы узнаете, как это сделать, используя исходный код C#.

## Шаг 1. Настройка среды

Прежде чем начать, убедитесь, что на вашем компьютере установлен Aspose.Cells for .NET. Также создайте новый проект в предпочитаемой вами среде разработки.

## Шаг 2. Импортируйте необходимые библиотеки.

В файл кода импортируйте библиотеки, необходимые для работы с Aspose.Cells. Вот соответствующий код:

```csharp
using Aspose.Cells;
```

## Шаг 3. Установите каталог документов

Укажите каталог, в котором находится документ Excel, с которым вы хотите работать. Используйте следующий код, чтобы установить каталог:

```csharp
string dataDir = "YOUR DOCUMENTS DIRECTORY";
```

Обязательно укажите полный путь к каталогу.

## Шаг 4. Создание объекта рабочей книги

Объект Workbook представляет документ Excel, с которым вы будете работать. Вы можете создать его, используя следующий код:

```csharp
Workbook workbook = new Workbook();
```

При этом создается новый пустой объект Workbook.

## Шаг 5. Сохранение URL-адреса изображения

Определите URL-адрес или путь к изображению, которое вы хотите вставить в верхний или нижний колонтитул. Используйте следующий код для хранения URL-адреса изображения:

```csharp
string logo_url = dataDir + "aspose-logo.jpg";
```

Убедитесь, что указан правильный путь и изображение существует в этом месте.

## Шаг 6: Открытие файла изображения

Чтобы открыть файл изображения, мы воспользуемся объектом FileStream и прочитаем двоичные данные из изображения. Вот соответствующий код:

```csharp
FileStream inFile;
byte[] binaryData;

inFile = new System.IO.FileStream(logo_url, System.IO.FileMode.Open, System.IO.FileAccess.Read);
binaryData = new Byte[inFile.Length];
long bytesRead = inFile.Read(binaryData, 0, (int)inFile.Length);
```

Убедитесь, что путь к изображению указан правильно и у вас есть необходимые разрешения для доступа к нему.

## Шаг 7. Настройка PageSetup

Объект PageSetup используется для установки параметров страницы документа Excel, включая верхний и нижний колонтитулы. Используйте следующий код, чтобы получить объект PageSetup первого листа:

```csharp
PageSetup pageSetup = workbook. Worksheets

[0].PageSetup;
```

Это позволит вам получить доступ к настройкам страницы для первого листа в книге.

## Шаг 8: Добавляем изображение в шапку

Используйте метод SetHeaderPicture() объекта PageSetup, чтобы установить изображение в средней части заголовка страницы. Вот соответствующий код:

```csharp
pageSetup.SetHeaderPicture(1, binaryData);
```

Это добавит указанное изображение в заголовок страницы.

## Шаг 9: Добавляем скрипт в шапку

Чтобы добавить скрипт в заголовок страницы, используйте метод SetHeader() объекта PageSetup. Вот соответствующий код:

```csharp
pageSetup.SetHeader(1, "&G");
```

Это добавит указанный скрипт в заголовок страницы. В этом примере сценарий «&G» отображает номер страницы.

## Шаг 10. Добавьте имя листа в заголовок

Чтобы отобразить имя листа в заголовке страницы, снова используйте метод SetHeader() объекта PageSetup. Вот соответствующий код:

```csharp
pageSetup.SetHeader(2, "&A");
```

Это добавит имя листа в заголовок страницы. Сценарий «&A» используется для обозначения имени листа.

## Шаг 11. Сохранение книги

Чтобы сохранить изменения в книге, используйте метод Save() объекта Workbook. Вот соответствующий код:

```csharp
workbook.Save(dataDir + "InsertImageInHeaderFooter_out.xls");
```

Это сохранит книгу с изменениями в указанном каталоге.

## Шаг 12: Закрытие FileStream

После чтения двоичных данных из изображения обязательно закройте FileStream, чтобы освободить ресурсы. Используйте следующий код, чтобы закрыть FileStream:

```csharp
inFile.Close();
```

Обязательно всегда закрывайте FileStreams, когда закончите их использовать.

### Пример исходного кода для вставки изображения в нижний колонтитул с использованием Aspose.Cells для .NET 
```csharp
//Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
//Создание объекта рабочей книги
Workbook workbook = new Workbook();
// Создание строковой переменной для хранения URL-адреса логотипа/изображения
string logo_url = dataDir + "aspose-logo.jpg";
// Объявление объекта FileStream
FileStream inFile;
// Объявление массива байтов
byte[] binaryData;
// Создание экземпляра объекта FileStream для открытия логотипа/изображения в потоке.
inFile = new System.IO.FileStream(logo_url, System.IO.FileMode.Open, System.IO.FileAccess.Read);
// Создание экземпляра массива байтов размера объекта FileStream
binaryData = new Byte[inFile.Length];
// Считывает блок байтов из потока и записывает данные в заданный буфер массива байтов.
long bytesRead = inFile.Read(binaryData, 0, (int)inFile.Length);
// Создание объекта PageSetup для получения настроек страницы первого листа книги.
PageSetup pageSetup = workbook.Worksheets[0].PageSetup;
// Установка логотипа/картинки в центральную часть шапки страницы
pageSetup.SetHeaderPicture(1, binaryData);
// Установка скрипта для логотипа/картинки
pageSetup.SetHeader(1, "&G");
// Установка имени Листа в правой части шапки страницы с помощью скрипта
pageSetup.SetHeader(2, "&A");
// Сохранение книги
workbook.Save(dataDir + "InsertImageInHeaderFooter_out.xls");
//Закрытие объекта FileStream
inFile.Close();       
```
## Заключение

Поздравляем! Теперь вы знаете, как вставить изображение в верхний или нижний колонтитул документа Excel с помощью Aspose.Cells для .NET. В этом руководстве вы пройдете каждый этап процесса: от настройки среды до сохранения измененной книги. Не стесняйтесь больше экспериментировать с функциями Aspose.Cells для создания персонализированных и профессиональных документов Excel.

### Часто задаваемые вопросы

#### Вопрос 1. Можно ли вставить несколько изображений в верхний или нижний колонтитул документа Excel?

О1: Да, вы можете вставить несколько изображений в верхний или нижний колонтитул документа Excel, повторяя шаги 8 и 9 для каждого дополнительного изображения.

#### Вопрос 2. Какие форматы изображений поддерживаются для вставки в верхний или нижний колонтитул?
A2: Aspose.Cells поддерживает множество распространенных форматов изображений, таких как JPEG, PNG, GIF, BMP и т. д.

#### Вопрос 3. Могу ли я дополнительно настроить внешний вид верхнего или нижнего колонтитула?

О3: Да, вы можете использовать специальные скрипты и коды для дальнейшего форматирования и настройки внешнего вида верхнего или нижнего колонтитула. Обратитесь к документации Aspose.Cells для получения дополнительной информации о параметрах настройки.

#### Вопрос 4. Работает ли Aspose.Cells с разными версиями Excel?

О4: Да, Aspose.Cells совместим с различными версиями Excel, включая Excel 2003, Excel 2007, Excel 2010, Excel 2013, Excel 2016 и Excel 2019.

#### Вопрос 5. Можно ли вставлять изображения в другие части документа Excel, например в ячейки или диаграммы?

О5: Да, Aspose.Cells предоставляет обширные функциональные возможности для вставки изображений в различные части документа Excel, включая ячейки, диаграммы и графические объекты.