---
title: Защитить определенную строку на листе Excel
linktitle: Защитить определенную строку на листе Excel
second_title: Справочник по API Aspose.Cells для .NET
description: Защитите определенную строку в Excel с помощью Aspose.Cells для .NET. Пошаговое руководство по защите ваших конфиденциальных данных.
type: docs
weight: 90
url: /ru/net/protect-excel-file/protect-specific-row-in-excel-worksheet/
---
Защита конфиденциальных данных в электронной таблице Excel необходима для обеспечения информационной безопасности. Aspose.Cells for .NET предлагает мощное решение для защиты определенных строк в электронной таблице Excel. В этом руководстве рассказывается, как защитить определенную строку на листе Excel с помощью предоставленного исходного кода C#. Выполните эти простые шаги, чтобы настроить защиту строк в файлах Excel.

## Шаг 1. Импортируйте необходимые библиотеки.

Для начала убедитесь, что в вашей системе установлен Aspose.Cells for .NET. Вам также необходимо добавить соответствующие ссылки в свой проект C#, чтобы иметь возможность использовать функциональность Aspose.Cells. Вот код для импорта необходимых библиотек:

```csharp
// Добавьте необходимые ссылки
using Aspose.Cells;
```

## Шаг 2. Создание книги и таблицы Excel

После импорта необходимых библиотек вы можете создать новую книгу Excel и новый лист. Вот как это сделать:

```csharp
//Путь к каталогу документов.
string dataDir = "YOUR DOCUMENTS DIRECTORY";

// Создайте каталог, если он еще не существует.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
     System.IO.Directory.CreateDirectory(dataDir);

// Создайте новую книгу.
Workbook wb = new Workbook();

// Создайте объект электронной таблицы и получите первый лист.
Worksheet sheet = wb.Worksheets[0];
```

## Шаг 3. Установка стиля и флага стиля

Теперь мы установим стиль ячейки и флаг стиля, чтобы разблокировать все столбцы на листе. Вот необходимый код:

```csharp
// Установите объект стиля.
Styling styling;

// Установите объект styleflag.
StyleFlag flag;

// Просмотрите все столбцы на листе и разблокируйте их.
for (int i = 0; i <= 255; i++)
{
     style = sheet.Cells.Columns[(byte)i].Style;
     style. IsLocked = false;
     flag = new StyleFlag();
     flag. Locked = true;
     sheet.Cells.Columns[(byte)i].ApplyStyle(style, flag);
}
```

## Шаг 4. Защитите конкретную линию

Теперь мы защитим конкретную строку на листе. Мы собираемся заблокировать первую строку, чтобы предотвратить любые изменения. Вот как:

```csharp
// Получите стиль первой строки.
style = sheet.Cells.Rows[0].Style;

// Закрой.
style. IsLocked = true;

//Создайте экземпляр флага.
flag = new StyleFlag();

// Установите параметр блокировки.
flag. Locked = true;

// Примените стиль к первой строке.
sheet.Cells.ApplyRowStyle(0, style, flag);
```

## Шаг 5. Защита листа

Наконец, мы защитим весь лист Excel от несанкционированного изменения. Вот как:

```csharp
// Защитите рабочий лист.
sheet.Protect(ProtectionType.All);
```

## Шаг 6. Сохраните защищенный файл Excel.

Завершив защиту определенной строки на листе Excel, вы можете сохранить защищенный файл Excel в своей системе. Вот как:

```csharp
// Сохраните файл Excel.
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```

Выполнив эти шаги, вы успешно защитите определенную строку в электронной таблице Excel с помощью Aspose.Cells для .NET.

### Пример исходного кода для защиты определенной строки на листе Excel с использованием Aspose.Cells для .NET 
```csharp
//Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// Создайте каталог, если он еще не существует.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
// Создайте новую книгу.
Workbook wb = new Workbook();
// Создайте объект рабочего листа и получите первый лист.
Worksheet sheet = wb.Worksheets[0];
// Определите объект стиля.
Style style;
// Определите объект styleflag.
StyleFlag flag;
// Просмотрите все столбцы на листе и разблокируйте их.
for (int i = 0; i <= 255; i++)
{
    style = sheet.Cells.Columns[(byte)i].Style;
    style.IsLocked = false;
    flag = new StyleFlag();
    flag.Locked = true;
    sheet.Cells.Columns[(byte)i].ApplyStyle(style, flag);
}
// Получите стиль первой строки.
style = sheet.Cells.Rows[0].Style;
// Закрой.
style.IsLocked = true;
//Создайте экземпляр флага.
flag = new StyleFlag();
// Установите настройку блокировки.
flag.Locked = true;
// Примените стиль к первой строке.
sheet.Cells.ApplyRowStyle(0, style, flag);
// Защитите лист.
sheet.Protect(ProtectionType.All);
// Сохраните файл Excel.
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```

## Заключение

Защита данных в файлах Excel имеет решающее значение для предотвращения несанкционированного доступа или нежелательного изменения. Используя библиотеку Aspose.Cells для .NET, вы можете легко защитить определенные строки в электронной таблице Excel, используя предоставленный исходный код C#. Следуйте этому пошаговому руководству, чтобы добавить дополнительный уровень безопасности к вашим файлам Excel.

### Часто задаваемые вопросы

#### Работает ли определенная защита строк во всех версиях Excel?

Да, специальная защита строк с использованием Aspose.Cells для .NET работает во всех поддерживаемых версиях Excel.

#### Могу ли я защитить несколько определенных строк в электронной таблице Excel?

Да, вы можете защитить несколько определенных строк, используя методы, описанные в этом руководстве.

#### Как я могу разблокировать определенную строку в электронной таблице Excel?

 Чтобы разблокировать определенную строку, вы должны соответствующим образом изменить исходный код, используя команду`IsLocked` метод`Style` объект.