---
title: Разрешить пользователю редактировать диапазоны на листе Excel
linktitle: Разрешить пользователю редактировать диапазоны на листе Excel
second_title: Справочник по API Aspose.Cells для .NET
description: Разрешите пользователям редактировать определенные диапазоны в электронной таблице Excel с помощью Aspose.Cells для .NET. Пошаговое руководство с исходным кодом на C#.
type: docs
weight: 10
url: /ru/net/protect-excel-file/allow-user-to-edit-ranges-in-excel-worksheet/
---
В этом руководстве мы расскажем вам, как использовать Aspose.Cells для .NET, чтобы позволить пользователю редактировать определенные диапазоны в электронной таблице Excel. Для выполнения этой задачи выполните следующие действия.

## Шаг 1. Настройка среды

Убедитесь, что вы настроили среду разработки и установили Aspose.Cells для .NET. Вы можете скачать последнюю версию библиотеки с официального сайта Aspose.

## Шаг 2. Импортируйте необходимые пространства имен.

В свой проект C# импортируйте необходимые пространства имен для работы с Aspose.Cells:

```csharp
using Aspose.Cells;
```

## Шаг 3: Установка пути к каталогу документов

 Объявить`dataDir` переменная, чтобы указать путь к каталогу, в котором вы хотите сохранить созданный файл Excel:

```csharp
string dataDir = "YOUR_DIRECTORY_OF_DOCUMENTS";
```

 Обязательно замените`"YOUR_DOCUMENT_DIRECTORY"` с правильным путем в вашей системе.

## Шаг 4. Создание объекта рабочей книги

Создайте экземпляр нового объекта Workbook, представляющего книгу Excel, которую вы хотите создать:

```csharp
Workbook book = new Workbook();
```

## Шаг 5. Доступ к первому листу.

Перейдите к первому листу книги Excel, используя следующий код:

```csharp
Worksheet sheet = book.Worksheets[0];
```

## Шаг 6. Получение разрешенных диапазонов изменений

 Получите коллекцию разрешенных диапазонов редактирования, используя`AllowEditRanges` свойство:

```csharp
ProtectedRangeCollection allowRanges = sheet.AllowEditRanges;
```

## Шаг 7. Определите защищенный диапазон

 Определите защищенный диапазон, используя`Add` метод`AllowEditRanges` коллекция:

```csharp
int idx = allowRanges.Add("r2", 1, 1, 3, 3);
protectedRange protectedRange = allowRanges[idx];
```

Здесь мы создали защищенный диапазон «r2», который простирается от ячейки A1 до ячейки C3.

## Шаг 8: Указание пароля

 Укажите пароль для защищенного диапазона с помощью`Password` свойство:

```csharp
protectedRange.Password = "YOUR_PASSWORD";
```

 Обязательно замените`"YOUR_PASSWORD"` с желаемым паролем.

## Шаг 9. Защита листа

 Защитите рабочий лист с помощью`Protect` метод`Worksheet` объект:

```csharp
sheet.Protect(ProtectionType.All);
```

Это защитит электронную таблицу, предотвращая любые изменения, выходящие за пределы допустимых диапазонов.

## Шаг 10: Регистрация

  файл Excel

 Сохраните созданный файл Excel, используя`Save` метод`Workbook` объект:

```csharp
book.Save(dataDir + "protectedrange.out.xls");
```

Обязательно укажите желаемое имя файла и правильный путь.

### Пример исходного кода для разрешения пользователю редактировать диапазоны на листе Excel с использованием Aspose.Cells для .NET 
```csharp
//Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// Создайте каталог, если он еще не существует.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
// Создать экземпляр новой книги
Workbook book = new Workbook();
// Получить первый лист (по умолчанию)
Worksheet sheet = book.Worksheets[0];
// Получите разрешенные диапазоны редактирования
ProtectedRangeCollection allowRanges = sheet.AllowEditRanges;
// Определить защищенный диапазон
ProtectedRange proteced_range;
// Создайте диапазон
int idx = allowRanges.Add("r2", 1, 1, 3, 3);
proteced_range = allowRanges[idx];
// Укажите пароль
proteced_range.Password = "123";
// Защитите лист
sheet.Protect(ProtectionType.All);
// Сохраните файл Excel
book.Save(dataDir + "protectedrange.out.xls");
```

## Заключение

Теперь вы узнали, как использовать Aspose.Cells для .NET, чтобы позволить пользователю редактировать определенные диапазоны в электронной таблице Excel. Не стесняйтесь продолжить изучение функций, предлагаемых Aspose.Cells, для удовлетворения ваших конкретных потребностей.


### Часто задаваемые вопросы

#### 1. Как разрешить пользователю редактировать определенные диапазоны в таблице Excel?

 Вы можете использовать`ProtectedRangeCollection` class для определения допустимых диапазонов изменений. Использовать`Add` метод для создания нового защищенного диапазона с нужными ячейками.

#### 2. Могу ли я установить пароль для авторизованных диапазонов модификации?

 Да, вы можете указать пароль, используя`Password` собственность`ProtectedRange` объект. Это ограничит доступ только для пользователей с паролем.

#### 3. Как защитить таблицу после установки разрешенных диапазонов?

 Использовать`Protect` метод`Worksheet` объект для защиты листа. Это предотвратит любые изменения за пределами разрешенных диапазонов, возможно, запросит пароль, если вы его указали.