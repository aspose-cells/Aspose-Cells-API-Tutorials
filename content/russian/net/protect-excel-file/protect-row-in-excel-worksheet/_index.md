---
title: Защитить строку на листе Excel
linktitle: Защитить строку на листе Excel
second_title: Справочник по Aspose.Cells для .NET API
description: В этом руководстве вы узнаете, как защитить строки электронной таблицы Excel с помощью Aspose.Cells для .NET. Пошаговое руководство по C#.
type: docs
weight: 60
url: /ru/net/protect-excel-file/protect-row-in-excel-worksheet/
---
В этом руководстве мы рассмотрим исходный код C#, который использует библиотеку Aspose.Cells для защиты строк в электронной таблице Excel. Мы рассмотрим каждый шаг кода и объясним, как он работает. Внимательно следуйте инструкциям, чтобы получить желаемый результат.

## Шаг 1: Предпосылки

Прежде чем начать, убедитесь, что у вас установлена библиотека Aspose.Cells для .NET. Вы можете получить его на официальном сайте Aspose. Также убедитесь, что у вас установлена последняя версия Visual Studio или любой другой среды разработки C#.

## Шаг 2. Импортируйте необходимые пространства имен

Чтобы использовать библиотеку Aspose.Cells, нам нужно импортировать в наш код необходимые пространства имен. Добавьте следующие строки в начало исходного файла C#:

```csharp
using Aspose.Cells;
```

## Шаг 3: Создание книги Excel

На этом шаге мы создадим новую книгу Excel. Используйте следующий код для создания книги Excel:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR_DIRECTORY_OF_DOCUMENTS";

// Создайте новую рабочую книгу.
Workbook wb = new Workbook();
```

 Обязательно замените`"YOUR_DOCUMENTS_DIR"` с соответствующим путем к вашему каталогу документов.

## Шаг 4: Создание электронной таблицы

Теперь, когда мы создали рабочую книгу Excel, давайте создадим рабочий лист и получим первый лист. Используйте следующий код:

```csharp
// Создайте объект электронной таблицы и получите первый лист.
Worksheet sheet = wb.Worksheets[0];
```

## Шаг 5: Определение стиля

На этом шаге мы определим стиль, который будет применяться к строкам электронной таблицы. Используйте следующий код:

```csharp
// Определение объекта стиля.
Styling styling;
```

## Шаг 6. Цикл, чтобы разблокировать все столбцы

Теперь мы пройдемся по всем столбцам на листе и разблокируем их. Используйте следующий код:

```csharp
// Прокрутите все столбцы на листе и разблокируйте их.
for (int i = 0; i <= 255; i++)
{
     style = sheet.Cells.Columns[(byte)i].Style;
     style. IsLocked = false;
     sheet.Cells.Columns[(byte)i].ApplyStyle(style);
}
```

## Шаг 7: Блокировка первой строки

На этом шаге мы заблокируем первую строку рабочего листа. Используйте следующий код:

```csharp
// Получите стиль первой строки.
style = sheet.Cells.Rows[0].Style;
// Заблокируйте стиль.
style. IsLocked = true;
// Примените стиль к первой строке.
sheet.Cells.ApplyRowStyle(0, style);
```

## Шаг 8: Защита рабочего листа

Теперь, когда мы установили стили и заблокировали строки, давайте защитим электронную таблицу. Используйте следующий код:

```csharp
// Защитите рабочий лист.
sheet.Protect(ProtectionType.All);
```

## Шаг 9: Сохранение файла Excel

Наконец, мы сохраним измененный файл Excel. Используйте следующий код:

```csharp
// Сохраните файл Excel.
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```

Обязательно укажите правильный путь для сохранения измененного файла Excel.

### Пример исходного кода для защиты строки на листе Excel с использованием Aspose.Cells для .NET 
```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// Создайте каталог, если он еще не существует.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
// Создайте новую рабочую книгу.
Workbook wb = new Workbook();
// Создайте объект рабочего листа и получите первый лист.
Worksheet sheet = wb.Worksheets[0];
// Определите объект стиля.
Style style;
// Определите объект styleflag.
StyleFlag flag;
// Прокрутите все столбцы на листе и разблокируйте их.
for (int i = 0; i <= 255; i++)
{
    style = sheet.Cells.Columns[(byte)i].Style;
    style.IsLocked = false;
    flag = new StyleFlag();
    flag.Locked = true;
    sheet.Cells.Columns[(byte)i].ApplyStyle(style, flag);
}
// Получите стиль первой строки.
style = sheet.Cells.Rows[0].Style;
// Закрой.
style.IsLocked = true;
//Создайте экземпляр флага.
flag = new StyleFlag();
// Установите настройку блокировки.
flag.Locked = true;
// Примените стиль к первой строке.
sheet.Cells.ApplyRowStyle(0, style, flag);
// Защитите лист.
sheet.Protect(ProtectionType.All);
// Сохраните файл Excel.
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```

## Заключение

Поздравляем! Теперь у вас есть исходный код C#, который позволяет защищать строки в электронной таблице Excel с помощью библиотеки Aspose.Cells для .NET. Обязательно внимательно следуйте инструкциям и настройте код в соответствии с вашими потребностями.

### Часто задаваемые вопросы (часто задаваемые вопросы)

#### Работает ли этот код с последними версиями Excel?

Да, этот код работает с последними версиями Excel, включая файлы в формате Excel 2010 и выше.

#### Могу ли я защитить только определенные строки, а не все строки на листе?

Да, вы можете изменить код, чтобы указать конкретные строки, которые вы хотите защитить. Вам нужно будет соответствующим образом настроить цикл и индексы.

#### Как снова разблокировать заблокированные линии?

 Вы можете использовать`IsLocked` метод`Style` объект для установки значения`false` и разблокировать ряды.

#### Можно ли защитить несколько листов в одной книге Excel?

Да, вы можете повторить шаги создания листа, установки стиля и защиты для каждого листа в книге.

#### Как я могу изменить пароль защиты электронной таблицы?

 Вы можете изменить пароль с помощью`Protect` и указав новый пароль в качестве аргумента.