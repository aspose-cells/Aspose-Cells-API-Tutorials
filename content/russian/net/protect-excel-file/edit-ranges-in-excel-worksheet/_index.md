---
title: Редактировать диапазоны на листе Excel
linktitle: Редактировать диапазоны на листе Excel
second_title: Справочник по API Aspose.Cells для .NET
description: Научитесь редактировать определенные диапазоны в электронной таблице Excel с помощью Aspose.Cells для .NET. Пошаговое руководство по C#.
type: docs
weight: 20
url: /ru/net/protect-excel-file/edit-ranges-in-excel-worksheet/
---
Microsoft Excel — мощный инструмент для создания электронных таблиц и управления ими, предлагающий множество функций для контроля и защиты данных. Одна из таких функций — позволить пользователям редактировать определенные диапазоны на листе, защищая при этом другие части. В этом руководстве мы шаг за шагом проведем вас по реализации этой функции с помощью Aspose.Cells для .NET, популярной библиотеки для программной работы с файлами Excel.

Использование Aspose.Cells для .NET позволит вам с легкостью манипулировать диапазонами в электронной таблице Excel, предоставляя удобный интерфейс и расширенные функции. Выполните следующие действия, чтобы позволить пользователям редактировать определенные диапазоны в электронной таблице Excel с помощью Aspose.Cells для .NET.
## Шаг 1. Настройка среды

Убедитесь, что в вашей среде разработки установлен Aspose.Cells for .NET. Загрузите библиотеку с официального сайта Aspose и проверьте документацию на наличие инструкций по установке.

## Шаг 2. Инициализация книги и листа

Для начала нам нужно создать новую книгу и получить ссылку на лист, на котором мы хотим разрешить изменение диапазонов. Для этого используйте следующий код:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENTS DIRECTORY";
// Создайте каталог, если он еще не существует.
bool exists = System.IO.Directory.Exists(dataDir);
if (! exists)
     System.IO.Directory.CreateDirectory(dataDir);

// Создать экземпляр новой книги
Workbook workbook = new Workbook();

// Получить первый лист (по умолчанию)
Worksheet sheet = workbook.Worksheets[0];
```

 В этом фрагменте кода мы сначала определяем путь к каталогу, в котором будет сохранен файл Excel. Далее мы создаем новый экземпляр`Workbook` класс и получите ссылку на первый лист, используя`Worksheets` свойство.

## Шаг 3. Получите редактируемые диапазоны

Теперь нам нужно получить диапазоны, в которых мы хотим разрешить изменение. Используйте следующий код:

```csharp
// Получить изменяемые диапазоны
ProtectedRangeCollection EditableRanges = Sheet.AllowEditRanges;
```

## Шаг 4. Установите защищенный диапазон

Прежде чем разрешить изменение диапазонов, нам необходимо определить защищенный диапазон. Вот как:

```csharp
// Определить защищенный диапазон
ProtectedRange ProtectedRange;

// Создайте диапазон
int index = ModifiableRanges.Add("r2", 1, 1, 3, 3);
rangeProtected = rangesEditable[index];
```

 В этом коде мы создаем новый экземпляр`ProtectedRange` класс и используйте`Add` метод для указания диапазона для защиты.

## Шаг 5: Укажите пароль

Для повышения безопасности вы можете указать пароль для защищенного диапазона. Вот как:

```csharp
// Укажите пароль
protectedBeach.Password = "YOUR_PASSWORD";
```

## Шаг 6. Защитите лист

Теперь, когда мы установили защищенный диапазон, мы можем защитить лист от несанкционированного изменения. Используйте следующий код:

```csharp
// Защитите рабочий лист
leaf.Protect(ProtectionType.All);
```

## Шаг 7. Сохраните файл Excel.

Наконец, сохраняем файл Excel с внесенными изменениями. Вот необходимый код:

```csharp
// Сохраните файл Excel
workbook.Save(dataDir + "protectedrange.out.xls");
```

### Пример исходного кода для редактирования диапазонов на листе Excel с использованием Aspose.Cells для .NET 
```csharp
//Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// Создайте каталог, если он еще не существует.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);

// Создать экземпляр новой книги
Workbook book = new Workbook();

// Получить первый лист (по умолчанию)
Worksheet sheet = book.Worksheets[0];

// Получите разрешенные диапазоны редактирования
ProtectedRangeCollection allowRanges = sheet.AllowEditRanges;

// Определить защищенный диапазон
ProtectedRange proteced_range;

// Создайте диапазон
int idx = allowRanges.Add("r2", 1, 1, 3, 3);
proteced_range = allowRanges[idx];

// Укажите пароль
proteced_range.Password = "YOUR_PASSWORD";

// Защитите лист
sheet.Protect(ProtectionType.All);

// Сохраните файл Excel
book.Save(dataDir + "protectedrange.out.xls");
```

## Заключение

Поздравляем! Вы узнали, как разрешить пользователям редактировать определенные диапазоны в электронной таблице Excel с помощью Aspose.Cells для .NET. Теперь вы можете применить эту технику в своих проектах и повысить безопасность файлов Excel.


#### Часто задаваемые вопросы

#### Вопрос: Почему мне следует использовать Aspose.Cells для .NET для редактирования диапазонов в электронной таблице Excel?

О: Aspose.Cells for .NET предлагает мощный и простой в использовании API для работы с файлами Excel. Он предоставляет расширенные функции, такие как манипулирование диапазоном, защита рабочего листа и т. д.

#### Вопрос: Могу ли я установить несколько редактируемых диапазонов на листе?

 О: Да, вы можете определить несколько редактируемых диапазонов, используя`Add` метод`ProtectedRangeCollection` коллекция. Каждый диапазон может иметь свои настройки защиты.

####  Вопрос: Можно ли удалить редактируемый диапазон после его определения?

 О: Да, вы можете использовать`RemoveAt` метод`ProtectedRangeCollection` Collection, чтобы удалить определенный редактируемый диапазон, указав его индекс.

#### Вопрос: Как открыть защищенный файл Excel после его сохранения?

О: Чтобы открыть защищенный файл Excel, вам потребуется ввести пароль, указанный при создании защищенного диапазона. Обязательно сохраните пароль в надежном месте, чтобы предотвратить потерю доступа к данным.