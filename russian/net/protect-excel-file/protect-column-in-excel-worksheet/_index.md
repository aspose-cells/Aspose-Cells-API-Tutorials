---
title: Защитить столбец на листе Excel
linktitle: Защитить столбец на листе Excel
second_title: Справочник по Aspose.Cells для .NET API
description: Узнайте, как защитить определенный столбец в Excel с помощью Aspose.Cells для .NET. Подробные шаги и исходный код включены.
type: docs
weight: 40
url: /ru/net/protect-excel-file/protect-column-in-excel-worksheet/
---
Microsoft Excel — популярное приложение для управления и анализа данных в виде электронных таблиц. Защита конфиденциальных данных необходима для обеспечения целостности и конфиденциальности информации. В этом руководстве мы шаг за шагом проведем вас по защите определенного столбца в электронной таблице Excel с помощью библиотеки Aspose.Cells for .NET. Aspose.Cells для .NET предлагает мощные функции для обработки и защиты файлов Excel. Следуйте инструкциям, чтобы узнать, как защитить данные в определенном столбце и защитить электронную таблицу Excel.
## Шаг 1: Настройка каталога

Начните с определения каталога, в котором вы хотите сохранить файл Excel. Используйте следующий код:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENTS DIRECTORY";
// Создайте каталог, если он не существует.
bool exists = System.IO.Directory.Exists(dataDir);
if (! exists)
     System.IO.Directory.CreateDirectory(dataDir);
```

Этот код проверяет, существует ли уже каталог, и создает его, если нет.

## Шаг 2: Создание новой книги

Далее мы создадим новую книгу Excel и получим первый рабочий лист. Используйте следующий код:

```csharp
// Создайте новую рабочую книгу.
Workbook workbook = new Workbook();
// Создайте объект электронной таблицы и получите первый лист.
Worksheet sheet = workbook.Worksheets[0];
```

 Этот код создает новый`Workbook` объект и получает первый рабочий лист, используя`Worksheets[0]`.

## Шаг 3: Разблокируйте столбцы

Чтобы разблокировать все столбцы на листе, мы будем использовать цикл, чтобы просмотреть все столбцы и применить стиль разблокировки. Используйте следующий код:

```csharp
// Установить объект стиля.
Styling styling;
// Установите объект styleflag.
StyleFlag flag;
// Прокрутите все столбцы на листе и разблокируйте их.
for (int i = 0; i <= 255; i++)
{
     style = sheet.Cells.Columns[(byte)i].Style;
     style. IsLocked = false;
     flag = new StyleFlag();
     flag. Locked = true;
     leaf.Cells.Columns[(byte)i].ApplyStyle(style, flag);
}
```

 Этот код перебирает каждый столбец на листе и разблокирует стиль, установив`IsLocked` к`false`.

## Шаг 4. Блокировка определенного столбца

Теперь мы собираемся заблокировать определенный столбец, применив заблокированный стиль. Используйте следующий код:

```csharp
// Получите стиль первого столбца.
style = sheet.Cells.Columns[0].Style;
// Закрой.
style. IsLocked = true;
// Создайте экземпляр объекта флага.
flag = new StyleFlag();
// Установите параметр блокировки.
flag. Locked = true;
// Примените стиль к первому столбцу.
sheet.Cells.Columns[0].ApplyStyle(style, flag);
```

 Этот код выбирает первый столбец, используя`Columns[0]` , затем задает стиль`IsLocked` к`true` чтобы заблокировать колонку. Наконец, мы применяем стиль к первому столбцу, используя`ApplyStyle` метод.

## Шаг 5: Защита рабочего листа

Теперь, когда мы заблокировали определенный столбец, мы можем защитить сам рабочий лист. Используйте следующий код:



```csharp
// Защитите рабочий лист.
leaf.Protect(ProtectionType.All);
```

 Этот код использует`Protect` метод защиты рабочего листа, указав тип защиты.

## Шаг 6: Сохранение файла Excel

Наконец, мы сохраняем файл Excel, используя нужный путь к каталогу и имя файла. Используйте следующий код:

```csharp
// Сохраните файл Excel.
workbook.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```

 Этот код использует`Save` метод`Workbook` объект для сохранения файла Excel с указанным именем и форматом файла.

### Пример исходного кода для защиты столбца на листе Excel с использованием Aspose.Cells для .NET 
```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// Создайте каталог, если он еще не существует.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
// Создайте новую рабочую книгу.
Workbook wb = new Workbook();
// Создайте объект рабочего листа и получите первый лист.
Worksheet sheet = wb.Worksheets[0];
// Определите объект стиля.
Style style;
// Определите объект styleflag.
StyleFlag flag;
// Прокрутите все столбцы на листе и разблокируйте их.
for (int i = 0; i <= 255; i++)
{
    style = sheet.Cells.Columns[(byte)i].Style;
    style.IsLocked = false;
    flag = new StyleFlag();
    flag.Locked = true;
    sheet.Cells.Columns[(byte)i].ApplyStyle(style, flag);
}
// Получите первый стиль столбца.
style = sheet.Cells.Columns[0].Style;
// Закрой.
style.IsLocked = true;
//Создайте экземпляр флага.
flag = new StyleFlag();
// Установите настройку блокировки.
flag.Locked = true;
// Примените стиль к первому столбцу.
sheet.Cells.Columns[0].ApplyStyle(style, flag);
// Защитите лист.
sheet.Protect(ProtectionType.All);
// Сохраните файл Excel.
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```

## Заключение

Вы только что выполнили пошаговое руководство по защите столбца в электронной таблице Excel с помощью Aspose.Cells для .NET. Вы узнали, как разблокировать все столбцы, заблокировать определенный столбец и защитить сам рабочий лист. Теперь вы можете применять эти концепции в своих проектах и защищать данные Excel.

## Часто задаваемые вопросы

#### Вопрос. Почему важно защищать определенные столбцы в электронной таблице Excel?

О: Защита определенных столбцов в электронной таблице Excel помогает ограничить доступ и изменение конфиденциальных данных, тем самым обеспечивая целостность и конфиденциальность информации.

#### В: Поддерживает ли Aspose.Cells for .NET другие функции для работы с файлами Excel?

О: Да, Aspose.Cells для .NET предлагает широкий спектр функций, включая создание, редактирование, преобразование файлов Excel и составление отчетов.

#### Вопрос. Как разблокировать все столбцы в электронной таблице Excel?

О: В Aspose.Cells для .NET вы можете использовать цикл для прохода по всем столбцам и установить стиль блокировки на «false», чтобы разблокировать все столбцы.

#### В: Как защитить электронную таблицу Excel с помощью Aspose.Cells для .NET?

 О: Вы можете использовать`Protect` метод объекта рабочего листа для защиты листа с различными уровнями защиты, такими как защита структуры, защита ячеек и т. д.

#### Вопрос. Можно ли применить эти концепции защиты столбцов к другим типам файлов Excel?

О: Да, концепции защиты столбцов в Aspose.Cells для .NET применимы ко всем типам файлов Excel, таким как файлы Excel 97-2003 (.xls) и более новые файлы Excel (.xlsx).