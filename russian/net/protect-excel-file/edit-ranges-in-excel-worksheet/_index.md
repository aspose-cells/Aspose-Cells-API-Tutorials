---
title: Редактировать диапазоны на листе Excel
linktitle: Редактировать диапазоны на листе Excel
second_title: Справочник по Aspose.Cells для .NET API
description: Научитесь редактировать определенные диапазоны в электронной таблице Excel с помощью Aspose.Cells для .NET. Пошаговое руководство по C#.
type: docs
weight: 20
url: /ru/net/protect-excel-file/edit-ranges-in-excel-worksheet/
---
Microsoft Excel — это мощный инструмент для создания и управления электронными таблицами, предлагающий множество функций для контроля и защиты данных. Одной из таких функций является предоставление пользователям возможности редактировать определенные диапазоны на листе, защищая при этом другие части. В этом руководстве мы шаг за шагом проведем вас по реализации этой функции с помощью Aspose.Cells for .NET, популярной библиотеки для программной работы с файлами Excel.

Использование Aspose.Cells для .NET позволит вам легко манипулировать диапазонами в электронной таблице Excel, предоставляя удобный интерфейс и расширенные функции. Выполните следующие действия, чтобы пользователи могли редактировать определенные диапазоны в электронной таблице Excel с помощью Aspose.Cells для .NET.
## Шаг 1. Настройка среды

Убедитесь, что в вашей среде разработки установлен Aspose.Cells for .NET. Загрузите библиотеку с официального сайта Aspose и ознакомьтесь с инструкциями по установке в документации.

## Шаг 2: Инициализация рабочей книги и рабочего листа

Для начала нам нужно создать новую рабочую книгу и получить ссылку на рабочий лист, где мы хотим разрешить изменение диапазонов. Для этого используйте следующий код:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENTS DIRECTORY";
// Создайте каталог, если он еще не существует.
bool exists = System.IO.Directory.Exists(dataDir);
if (! exists)
     System.IO.Directory.CreateDirectory(dataDir);

// Создание новой книги
Workbook workbook = new Workbook();

// Получить первый рабочий лист (по умолчанию)
Worksheet sheet = workbook.Worksheets[0];
```

 В этом фрагменте кода мы сначала определяем путь к каталогу, в котором будет сохранен файл Excel. Далее мы создаем новый экземпляр`Workbook` класс и получить ссылку на первый рабочий лист, используя`Worksheets`свойство.

## Шаг 3: Получите редактируемые диапазоны

Теперь нам нужно получить диапазоны, в которых мы хотим разрешить модификацию. Используйте следующий код:

```csharp
// Получить изменяемые диапазоны
ProtectedRangeCollection EditableRanges = Sheet.AllowEditRanges;
```

## Шаг 4: Установите защищенный диапазон

Прежде чем разрешить изменение диапазонов, нам нужно определить защищенный диапазон. Вот как:

```csharp
// Определить защищенный диапазон
ProtectedRange ProtectedRange;

// Создать диапазон
int index = ModifiableRanges.Add("r2", 1, 1, 3, 3);
rangeProtected = rangesEditable[index];
```

 В этом коде мы создаем новый экземпляр`ProtectedRange` класс и использовать`Add` способ указать диапазон для защиты.

## Шаг 5: Укажите пароль

Для повышения безопасности можно указать пароль для защищенного диапазона. Вот как:

```csharp
// Укажите пароль
protectedBeach.Password = "YOUR_PASSWORD";
```

## Шаг 6: Защитите рабочий лист

Теперь, когда мы установили защищенный диапазон, мы можем защитить рабочий лист, чтобы предотвратить несанкционированное изменение. Используйте следующий код:

```csharp
// Защитите рабочий лист
leaf.Protect(ProtectionType.All);
```

## Шаг 7: Сохраните файл Excel

Наконец, мы сохраняем файл Excel с внесенными изменениями. Вот необходимый код:

```csharp
// Сохраните файл Excel
workbook.Save(dataDir + "protectedrange.out.xls");
```

### Пример исходного кода для редактирования диапазонов на листе Excel с использованием Aspose.Cells для .NET 
```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// Создайте каталог, если он еще не существует.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);

// Создание новой книги
Workbook book = new Workbook();

// Получить первый (по умолчанию) рабочий лист
Worksheet sheet = book.Worksheets[0];

// Получить разрешенные диапазоны редактирования
ProtectedRangeCollection allowRanges = sheet.AllowEditRanges;

// Определить защищенный диапазон
ProtectedRange proteced_range;

// Создать диапазон
int idx = allowRanges.Add("r2", 1, 1, 3, 3);
proteced_range = allowRanges[idx];

// Укажите пароль
proteced_range.Password = "YOUR_PASSWORD";

// Защитите лист
sheet.Protect(ProtectionType.All);

// Сохраните файл Excel
book.Save(dataDir + "protectedrange.out.xls");
```

## Заключение

Поздравляем! Вы узнали, как разрешить пользователям редактировать определенные диапазоны в электронной таблице Excel с помощью Aspose.Cells для .NET. Теперь вы можете применять эту технику в своих проектах и повысить безопасность файлов Excel.


#### Часто задаваемые вопросы

#### В: Почему мне следует использовать Aspose.Cells for .NET для редактирования диапазонов в электронной таблице Excel?
О: Aspose.Cells for .NET предлагает мощный и простой в использовании API для работы с файлами Excel. Он предоставляет расширенные функции, такие как манипулирование диапазоном, защита рабочего листа и т. д.

#### В: Могу ли я установить несколько редактируемых диапазонов на листе?
 О: Да, вы можете определить несколько редактируемых диапазонов, используя`Add` метод`ProtectedRangeCollection` коллекция. Каждый диапазон может иметь свои настройки защиты.

####  В: Можно ли удалить редактируемый диапазон после его определения?
 О: Да, вы можете использовать`RemoveAt` метод`ProtectedRangeCollection` collection, чтобы удалить определенный редактируемый диапазон, указав его индекс.

#### Q: Как я могу открыть защищенный файл Excel после его сохранения?
A: Вам нужно будет указать пароль, указанный при создании защищенного диапазона, чтобы открыть защищенный файл Excel. Обязательно храните пароль в надежном месте, чтобы предотвратить потерю доступа к данным.