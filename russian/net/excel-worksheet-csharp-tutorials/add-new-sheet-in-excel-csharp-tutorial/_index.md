---
title: Добавить новый лист в Excel С# Учебник
linktitle: Добавить новый лист в Excel
second_title: Справочник по Aspose.Cells для .NET API
description: Узнайте, как добавить новый лист в Excel с помощью Aspose.Cells для .NET. Пошаговое руководство с исходным кодом на C#.
type: docs
weight: 20
url: /ru/net/excel-worksheet-csharp-tutorials/add-new-sheet-in-excel-csharp-tutorial/
---
В этом руководстве мы шаг за шагом объясним исходный код C# для добавления нового листа в Excel с использованием Aspose.Cells для .NET. Добавление нового листа в книгу Excel — обычная операция при создании отчетов или управлении данными. Aspose.Cells — это мощная библиотека, которая позволяет легко манипулировать файлами Excel и создавать их с помощью .NET. Выполните следующие шаги, чтобы понять и реализовать этот код.

## Шаг 1: Настройка каталога документов

Первым шагом является определение каталога документов, в котором будет сохранен файл Excel. Если каталог не существует, мы создаем его, используя следующий код:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENTS DIRECTORY";
// Создайте каталог, если он еще не существует.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
System.IO.Directory.CreateDirectory(dataDir);
```

Обязательно замените «КАТАЛОГ ВАШИХ ДОКУМЕНТОВ» на соответствующий путь к каталогу ваших документов.

## Шаг 2. Создание экземпляра объекта рабочей книги

Второй шаг — создание экземпляра объекта Workbook, представляющего книгу Excel. Используйте следующий код:

```csharp
Workbook workbook = new Workbook();
```

Этот объект будет использоваться для добавления нового листа и выполнения других операций с книгой Excel.

## Шаг 3: Добавление нового рабочего листа

Третий шаг — добавить новый рабочий лист в объект Workbook. Используйте следующий код:

```csharp
int index = workbook. Worksheets. Add();
Worksheet worksheet = workbook.Worksheets[index];
```

Это добавит новый рабочий лист в объект Workbook, и вы получите ссылку на этот рабочий лист, используя его индекс.

## Шаг 4: Установка имени нового рабочего листа

Четвертый шаг — дать новому рабочему листу имя. Вы можете использовать следующий код для установки имени рабочего листа:

```csharp
worksheet.Name = "My Worksheet";
```

Замените «Моя электронная таблица» желаемым именем для нового листа.

## Шаг 5: Сохранение файла Excel

Наконец, последний шаг — сохранить файл Excel. Используйте следующий код:

```csharp
string filePath = dataDir + "output.out.xls";
workbook.Save(filePath);
```

Это сохранит книгу Excel с новым рабочим листом в указанном вами каталоге документов.

### Пример исходного кода для учебника по добавлению нового листа в Excel C# с использованием Aspose.Cells для .NET 
```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// Создайте каталог, если он еще не существует.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
	System.IO.Directory.CreateDirectory(dataDir);
// Создание экземпляра объекта Workbook
Workbook workbook = new Workbook();
// Добавление нового рабочего листа в объект Workbook
int i = workbook.Worksheets.Add();
// Получение ссылки на недавно добавленный рабочий лист путем передачи его индекса листа
Worksheet worksheet = workbook.Worksheets[i];
// Установка имени вновь добавленного рабочего листа
worksheet.Name = "My Worksheet";
// Сохранение файла Excel
workbook.Save(dataDir + "output.out.xls");
```

## Заключение

Теперь вы узнали, как добавить новый рабочий лист в Excel с помощью Aspose.Cells для .NET. Вы можете использовать этот метод для управления и создания файлов Excel с помощью C#. Aspose.Cells предлагает множество мощных функций, упрощающих работу с файлами Excel в ваших приложениях.

### Часто задаваемые вопросы (FAQ)

#### Могу ли я использовать Aspose.Cells с другими языками программирования, кроме C#?

Да, Aspose.Cells поддерживает несколько языков программирования, таких как Java, Python, Ruby и многие другие.

#### Могу ли я добавить форматирование к ячейкам на вновь созданном листе?

О: Да, вы можете применить форматирование к ячейкам, используя методы, предоставляемые классом Worksheet Aspose.Cells. Вы можете установить стиль ячейки, изменить цвет фона, применить границы и т. д.

#### Как я могу получить доступ к данным ячейки из нового рабочего листа?

Вы можете получить доступ к данным ячейки, используя свойства и методы, предоставляемые классом Worksheet Aspose.Cells. Например, вы можете использовать свойство Cells для доступа к определенной ячейке и извлечения или изменения ее значения.

#### Поддерживает ли Aspose.Cells формулы в Excel?

Да, Aspose.Cells поддерживает формулы Excel. Вы можете установить формулы в ячейках листа, используя метод SetFormula класса Cell.
