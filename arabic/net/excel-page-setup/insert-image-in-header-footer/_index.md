---
title: إدراج صورة في رأس تذييل الصفحة
linktitle: إدراج صورة في رأس تذييل الصفحة
second_title: Aspose.Cells لمرجع .NET API
description: تعرف على كيفية إدراج صورة في رأس أو تذييل مستند Excel باستخدام Aspose.Cells for .NET. دليل خطوة بخطوة مع شفرة المصدر في C #.
type: docs
weight: 60
url: /ar/net/excel-page-setup/insert-image-in-header-footer/
---
يمكن أن تكون القدرة على إدراج صورة في رأس أو تذييل مستند Excel مفيدة جدًا لتخصيص تقاريرك أو إضافة شعارات الشركة. في هذه المقالة ، سنوجهك خطوة بخطوة لإدراج صورة في رأس أو تذييل مستند Excel باستخدام Aspose.Cells for .NET. سوف تتعلم كيفية تحقيق ذلك باستخدام شفرة المصدر C #.

## الخطوة الأولى: تهيئة البيئة

قبل أن تبدأ ، تأكد من تثبيت Aspose.Cells for .NET على جهازك. قم أيضًا بإنشاء مشروع جديد في بيئة التطوير المفضلة لديك.

## الخطوة 2: استيراد المكتبات الضرورية

في ملف التعليمات البرمجية الخاص بك ، قم باستيراد المكتبات اللازمة للعمل مع Aspose.Cells. هذا هو الكود المقابل:

```csharp
using Aspose.Cells;
```

## الخطوة 3: تعيين دليل المستندات

قم بتعيين الدليل حيث يوجد مستند Excel الذي تريد العمل معه. استخدم الكود التالي لتعيين الدليل:

```csharp
string dataDir = "YOUR DOCUMENTS DIRECTORY";
```

تأكد من تحديد مسار الدليل الكامل.

## الخطوة 4: إنشاء كائن مصنف

يمثل كائن المصنف مستند Excel الذي ستعمل به. يمكنك إنشائه باستخدام الكود التالي:

```csharp
Workbook workbook = new Workbook();
```

يؤدي هذا إلى إنشاء كائن مصنف فارغ جديد.

## الخطوة 5: تخزين عنوان URL الخاص بالصورة

حدد عنوان URL أو مسار الصورة التي تريد إدراجها في الرأس أو التذييل. استخدم الكود التالي لتخزين عنوان URL للصورة:

```csharp
string logo_url = dataDir + "aspose-logo.jpg";
```

تأكد من صحة المسار المحدد وأن الصورة موجودة في هذا الموقع.

## الخطوة السادسة: فتح ملف الصورة

لفتح ملف الصورة ، سنستخدم كائن FileStream ونقرأ البيانات الثنائية من الصورة. هذا هو الكود المقابل:

```csharp
FileStream inFile;
byte[] binaryData;

inFile = new System.IO.FileStream(logo_url, System.IO.FileMode.Open, System.IO.FileAccess.Read);
binaryData = new Byte[inFile.Length];
long bytesRead = inFile.Read(binaryData, 0, (int)inFile.Length);
```

تأكد من صحة مسار الصورة ولديك الأذونات الصحيحة للوصول إليها.

## الخطوة 7: تكوين PageSetup

يتم استخدام كائن PageSetup لتعيين إعدادات صفحة مستند Excel بما في ذلك الرأس والتذييل. استخدم الكود التالي للحصول على كائن PageSetup من ورقة العمل الأولى:

```csharp
PageSetup pageSetup = workbook. Worksheets

[0].PageSetup;
```

سيسمح لك ذلك بالوصول إلى إعدادات الصفحة لورقة العمل الأولى في المصنف.

## الخطوة 8: إضافة الصورة إلى العنوان

استخدم الأسلوب SetHeaderPicture () لكائن PageSetup لتعيين الصورة في القسم الأوسط من رأس الصفحة. هذا هو الكود المقابل:

```csharp
pageSetup.SetHeaderPicture(1, binaryData);
```

سيؤدي هذا إلى إضافة الصورة المحددة إلى رأس الصفحة.

## الخطوة 9: إضافة برنامج نصي إلى العنوان

لإضافة برنامج نصي إلى رأس الصفحة ، استخدم الأسلوب SetHeader () لكائن PageSetup. هذا هو الكود المقابل:

```csharp
pageSetup.SetHeader(1, "&G");
```

سيؤدي هذا إلى إضافة البرنامج النصي المحدد إلى رأس الصفحة. في هذا المثال ، يعرض البرنامج النصي "& G" رقم الصفحة.

## الخطوة 10: أضف اسم الورقة إلى العنوان

لعرض اسم الورقة في رأس الصفحة ، استخدم الأسلوب SetHeader () لكائن PageSetup مرة أخرى. هذا هو الكود المقابل:

```csharp
pageSetup.SetHeader(2, "&A");
```

سيؤدي هذا إلى إضافة اسم الورقة إلى رأس الصفحة. يتم استخدام البرنامج النصي "& A" لتمثيل اسم الورقة.

## الخطوة 11: حفظ المصنف

لحفظ التغييرات في المصنف ، استخدم الأسلوب Save () لكائن المصنف. هذا هو الكود المقابل:

```csharp
workbook.Save(dataDir + "InsertImageInHeaderFooter_out.xls");
```

سيؤدي هذا إلى حفظ المصنف بالتغييرات التي تم إجراؤها على الدليل المحدد.

## الخطوة 12: إغلاق FileStream

بعد قراءة البيانات الثنائية من الصورة ، تأكد من إغلاق FileStream لتحرير الموارد. استخدم الكود التالي لإغلاق FileStream:

```csharp
inFile.Close();
```

تأكد من إغلاق FileStreams دائمًا عند الانتهاء من استخدامها.

### نموذج التعليمات البرمجية المصدر لإدراج صورة في رأس تذييل باستخدام Aspose.Cells لـ .NET 
```csharp
// المسار إلى دليل المستندات.
string dataDir = "YOUR DOCUMENT DIRECTORY";
//إنشاء كائن مصنف
Workbook workbook = new Workbook();
// إنشاء متغير سلسلة لتخزين عنوان url الخاص بالشعار / الصورة
string logo_url = dataDir + "aspose-logo.jpg";
// التصريح عن كائن FileStream
FileStream inFile;
// إعلان مصفوفة بايت
byte[] binaryData;
// إنشاء مثيل لكائن FileStream لفتح الشعار / الصورة في الدفق
inFile = new System.IO.FileStream(logo_url, System.IO.FileMode.Open, System.IO.FileAccess.Read);
// إنشاء مصفوفة بايت من حجم كائن FileStream
binaryData = new Byte[inFile.Length];
// يقرأ كتلة من البايت من الدفق ويكتب البيانات في مخزن مؤقت معين لصفيف البايت.
long bytesRead = inFile.Read(binaryData, 0, (int)inFile.Length);
// إنشاء كائن PageSetup للحصول على إعدادات الصفحة لورقة العمل الأولى من المصنف
PageSetup pageSetup = workbook.Worksheets[0].PageSetup;
// وضع الشعار / الصورة في القسم الأوسط من رأس الصفحة
pageSetup.SetHeaderPicture(1, binaryData);
// ضبط البرنامج النصي للشعار / الصورة
pageSetup.SetHeader(1, "&G");
// تعيين اسم الورقة في القسم الأيمن من رأس الصفحة مع النص البرمجي
pageSetup.SetHeader(2, "&A");
// حفظ المصنف
workbook.Save(dataDir + "InsertImageInHeaderFooter_out.xls");
//إغلاق كائن FileStream
inFile.Close();       
```
## خاتمة

تهنئة ! أنت تعرف الآن كيفية إدراج صورة في رأس أو تذييل مستند Excel باستخدام Aspose.Cells for .NET. يرشدك هذا البرنامج التعليمي خلال كل خطوة من خطوات العملية ، من إعداد البيئة إلى حفظ المصنف المعدل. لا تتردد في تجربة المزيد مع ميزات Aspose.Cells لإنشاء مستندات Excel مخصصة واحترافية.

### التعليمات

#### س 1: هل من الممكن إدراج صور متعددة في رأس أو تذييل مستند Excel؟

ج 1: نعم ، يمكنك إدراج صور متعددة في رأس أو تذييل مستند Excel عن طريق تكرار الخطوتين 8 و 9 لكل صورة إضافية.

#### س ٢: ما هي تنسيقات الصور المعتمدة للإدراج في الرأس أو التذييل؟
A2: Aspose.Cells يدعم مجموعة متنوعة من تنسيقات الصور الشائعة مثل JPEG و PNG و GIF و BMP ، إلخ.

#### Q3: هل يمكنني تخصيص مظهر الرأس أو التذييل بشكل أكبر؟

ج ٣: نعم ، يمكنك استخدام نصوص ورموز خاصة لتنسيق وتخصيص مظهر الرأس أو التذييل. راجع وثائق Aspose.Cells لمزيد من المعلومات حول خيارات التخصيص.

#### س 4: هل تعمل Aspose.Cells مع إصدارات مختلفة من Excel؟

A4: نعم ، Aspose.Cells متوافق مع إصدارات مختلفة من Excel بما في ذلك Excel 2003 و Excel 2007 و Excel 2010 و Excel 2013 و Excel 2016 و Excel 2019.

#### س 5: هل من الممكن إدراج صور في أجزاء أخرى من مستند Excel ، مثل الخلايا أو المخططات؟

ج 5: نعم ، يوفر Aspose.Cells وظائف واسعة لإدراج الصور في أجزاء مختلفة من مستند Excel ، بما في ذلك الخلايا والمخططات وكائنات الرسوم.