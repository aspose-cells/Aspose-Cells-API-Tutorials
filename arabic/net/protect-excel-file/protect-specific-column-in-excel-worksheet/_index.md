---
title: حماية عمود معين في ورقة عمل Excel
linktitle: حماية عمود معين في ورقة عمل Excel
second_title: Aspose.Cells لمرجع .NET API
description: تعرف على كيفية حماية عمود معين في ورقة Excel باستخدام Aspose.Cells for .NET. دليل خطوة بخطوة في C #.
type: docs
weight: 80
url: /ar/net/protect-excel-file/protect-specific-column-in-excel-worksheet/
---
عند العمل باستخدام أوراق عمل Excel في C # ، غالبًا ما يكون من الضروري حماية أعمدة معينة لمنع التعديلات العرضية. في هذا البرنامج التعليمي ، سنوجهك خلال عملية حماية عمود معين في ورقة عمل Excel باستخدام مكتبة Aspose.Cells for .NET. سنزودك بشرح خطوة بخطوة لشفرة المصدر C # المطلوبة لهذه المهمة. اذا هيا بنا نبدأ!

## نظرة عامة حول حماية أعمدة معينة في ورقة عمل Excel

تضمن حماية أعمدة معينة في ورقة عمل Excel أن تظل هذه الأعمدة مقفلة ولا يمكن تعديلها بدون إذن مناسب. يكون هذا مفيدًا بشكل خاص عندما تريد تقييد الوصول إلى بيانات أو صيغ معينة للتحرير مع السماح للمستخدمين بالتفاعل مع بقية ورقة العمل. توفر مكتبة Aspose.Cells for .NET مجموعة شاملة من الميزات لمعالجة ملفات Excel برمجيًا ، بما في ذلك حماية العمود.

## تهيئة البيئة

قبل أن نبدأ ، تأكد من تثبيت مكتبة Aspose.Cells for .NET في بيئة التطوير لديك. يمكنك تنزيل المكتبة من موقع Aspose الرسمي وتثبيتها باستخدام المثبت المتوفر.

## إنشاء مصنف جديد وورقة عمل

لبدء حماية أعمدة معينة ، نحتاج إلى إنشاء مصنف جديد وورقة عمل جديدة باستخدام Aspose.Cells for .NET. إليك مقتطف الشفرة:

```csharp
// المسار إلى دليل المستندات.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// قم بإنشاء دليل إذا لم يكن موجودًا بالفعل.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);

// قم بإنشاء مصنف جديد.
Workbook wb = new Workbook();

// قم بإنشاء كائن ورقة عمل والحصول على الورقة الأولى.
Worksheet sheet = wb.Worksheets[0];
```

تأكد من استبدال "دليل المستند" بمسار الدليل الفعلي حيث تريد حفظ ملف Excel.

## تحديد نمط ونمط كائنات العلم

من أجل تعيين أنماط محددة وأعلام حماية للأعمدة ، نحتاج إلى تحديد كائنات نمط وعلامة النمط. إليك مقتطف الشفرة:

```csharp
// تحديد كائن النمط.
Style style;

// حدد كائن علامة النمط.
StyleFlag flag;
```

## التكرار خلال الأعمدة وفتحها

بعد ذلك ، نحتاج إلى تكرار جميع الأعمدة في ورقة العمل وإلغاء تأمينها. سيضمن هذا أن جميع الأعمدة قابلة للتعديل باستثناء العمود الذي نريد حمايته. إليك مقتطف الشفرة:

```csharp
// قم بالتكرار خلال جميع الأعمدة في ورقة العمل وقم بإلغاء تأمينها.
for (int i = 0; i <= 255; i++)
{
    style = sheet.Cells.Columns[(byte)i].Style;
    style.IsLocked = false;
    flag = new StyleFlag();
    flag.Locked = true;
    sheet.Cells.Columns[(byte)i].ApplyStyle(style, flag);
}
```

## قفل عمود معين

الآن ، دعنا نغلق عمودًا معينًا. في هذا المثال ، سنغلق العمود الأول (فهرس العمود 0). إليك مقتطف الشفرة:

```csharp
// احصل على نمط العمود الأول.
style = sheet.Cells.Columns[0].Style;

// أغلق.
style.IsLocked = true;
```

## تطبيق الأنماط على الأعمدة

بعد قفل العمود المحدد ، نحتاج إلى تطبيق النمط والعلامة على هذا العمود. إليك مقتطف الشفرة:

```csharp
//تجسيد العلم.
flag = new StyleFlag();

// اضبط إعداد القفل.
flag.Locked = true;

// قم بتطبيق النمط على العمود الأول.
sheet.Cells.Columns[0].ApplyStyle(style, flag);
```

## حماية ورقة العمل

لإنهاء الحماية ، نحتاج إلى حماية ورقة العمل لضمان عدم إمكانية تعديل الأعمدة المقفلة. إليك مقتطف الشفرة:

```csharp
// احمِ الورقة.
sheet.Protect(ProtectionType.All);
```

## حفظ ملف Excel

أخيرًا ، سنقوم بحفظ ملف Excel المعدل في الموقع المطلوب. إليك مقتطف الشفرة:

```csharp
// احفظ ملف اكسل.
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```

تأكد من استبدال "output.out.xls" باسم الملف المطلوب وامتداده.

### نموذج التعليمات البرمجية المصدر لحماية عمود معين في ورقة عمل Excel باستخدام Aspose.Cells for .NET 
```csharp
// المسار إلى دليل المستندات.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// قم بإنشاء دليل إذا لم يكن موجودًا بالفعل.
bool IsExists = System.IO.Directory.Exists(dataDir);
if (!IsExists)
    System.IO.Directory.CreateDirectory(dataDir);
// قم بإنشاء مصنف جديد.
Workbook wb = new Workbook();
// قم بإنشاء كائن ورقة عمل والحصول على الورقة الأولى.
Worksheet sheet = wb.Worksheets[0];
// تحديد كائن النمط.
Style style;
// تحديد كائن styleflag.
StyleFlag flag;
// قم بالتكرار خلال جميع الأعمدة في ورقة العمل وقم بإلغاء تأمينها.
for (int i = 0; i <= 255; i++)
{
    style = sheet.Cells.Columns[(byte)i].Style;
    style.IsLocked = false;
    flag = new StyleFlag();
    flag.Locked = true;
    sheet.Cells.Columns[(byte)i].ApplyStyle(style, flag);
}
// احصل على نمط العمود الأول.
style = sheet.Cells.Columns[0].Style;
// أغلق.
style.IsLocked = true;
//تجسيد العلم.
flag = new StyleFlag();
// اضبط إعداد القفل.
flag.Locked = true;
// قم بتطبيق النمط على العمود الأول.
sheet.Cells.Columns[0].ApplyStyle(style, flag);
// احمِ الورقة.
sheet.Protect(ProtectionType.All);
// احفظ ملف اكسل.
wb.Save(dataDir + "output.out.xls", SaveFormat.Excel97To2003);
```

## خاتمة

في هذا البرنامج التعليمي ، أوضحنا العملية خطوة بخطوة لحماية عمود معين في ورقة عمل Excel باستخدام مكتبة Aspose.Cells for .NET. لقد بدأنا بإنشاء مصنف جديد وورقة عمل جديدة ، وتحديد كائنات علامة النمط والنمط ، ثم انتقلنا إلى إلغاء قفل أعمدة محددة وقفلها. أخيرًا ، قمنا بحماية ورقة العمل وحفظنا ملف Excel المعدل. باتباع هذا الدليل ، يجب أن تكون الآن قادرًا على حماية أعمدة معينة في أوراق عمل Excel باستخدام C # و Aspose.Cells for .NET.

### الأسئلة المتداولة (FAQs)

#### هل يمكنني حماية عدة أعمدة باستخدام هذه الطريقة؟

نعم ، يمكنك حماية أعمدة متعددة عن طريق تعديل الكود وفقًا لذلك. ما عليك سوى إجراء حلقة عبر نطاق العمود المطلوب وتطبيق أنماط القفل والأعلام.

#### هل من الممكن حماية ورقة العمل المحمية بكلمة مرور؟

 نعم ، يمكنك إضافة حماية كلمة المرور إلى ورقة العمل المحمية عن طريق تحديد كلمة المرور أثناء استدعاء`Protect` طريقة.

#### هل يدعم Aspose.Cells for .NET تنسيقات ملفات Excel الأخرى؟

نعم ، يدعم Aspose.Cells for .NET تنسيقات ملفات Excel المختلفة ، بما في ذلك XLS و XLSX و XLSM والمزيد.

#### هل يمكنني حماية صفوف معينة بدلاً من الأعمدة؟

نعم ، يمكنك تعديل التعليمات البرمجية لحماية صفوف معينة بدلاً من الأعمدة من خلال تطبيق الأنماط والعلامات على خلايا الصف بدلاً من خلايا الأعمدة.